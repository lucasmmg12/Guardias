(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80828,e=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.s(["default",()=>t])},5097,e=>{"use strict";let t=(0,e.i(71434).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],5097)},7987,e=>{"use strict";var t=e.i(9964),a=e.i(87312),r=e.i(97451);let s=a.forwardRef(({className:e,type:a,...s},l)=>(0,t.jsx)("input",{type:a,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:l,...s}));s.displayName="Input",e.s(["Input",()=>s])},19029,e=>{"use strict";let t=(0,e.i(71434).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],19029)},23164,e=>{"use strict";let t=(0,e.i(71434).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>t],23164)},41253,e=>{"use strict";var t=e.i(9964),a=e.i(87312),r=e.i(7987),s=e.i(83643),l=e.i(71434);let i=(0,l.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var o=e.i(68499);let n=(0,l.default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var c=e.i(97451);function d({value:e,type:l="text",onSave:d,className:x,isEditable:m=!0,columnName:u}){let[h,g]=(0,a.useState)(!1),[b,p]=(0,a.useState)(e??""),[y,f]=(0,a.useState)(!1),N=(0,a.useRef)(null),j=(0,a.useMemo)(()=>u?.toLowerCase().trim()==="cliente",[u]),v=(0,a.useMemo)(()=>j?(0,c.obtenerSugerenciasObraSocial)(String(e)):[],[j,e]);(0,a.useEffect)(()=>{p(e??"")},[e]),(0,a.useEffect)(()=>{h&&N.current&&N.current.focus()},[h]);let w=(0,a.useCallback)(async()=>{if(b===e)return void g(!1);f(!0);try{await d(b),g(!1)}catch(e){console.error("Error saving:",e)}finally{f(!1)}},[b,e,d]),C=(0,a.useCallback)(()=>{p(e??""),g(!1)},[e]),k=(0,a.useCallback)(e=>{"Enter"===e.key?w():"Escape"===e.key&&C()},[w,C]);if(!m)return(0,t.jsx)("div",{className:(0,c.cn)("px-2 py-1",x),children:e});if(h)return(0,t.jsxs)("div",{className:"flex flex-col gap-1 animate-in fade-in zoom-in-95 duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(r.Input,{ref:N,type:l,value:b,onChange:e=>p("number"===l?Number(e.target.value):e.target.value),onKeyDown:k,disabled:y,className:"h-8 min-w-[100px] bg-gray-800 border-green-500/50 focus:border-green-400 text-white",placeholder:j?"Ingrese obra social o cÃ³digo":void 0}),(0,t.jsx)(s.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 text-green-400 hover:text-green-300 hover:bg-green-500/20",onClick:w,disabled:y,children:(0,t.jsx)(i,{className:"h-4 w-4"})}),(0,t.jsx)(s.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 text-red-400 hover:text-red-300 hover:bg-red-500/20",onClick:C,disabled:y,children:(0,t.jsx)(o.X,{className:"h-4 w-4"})})]}),j&&v.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:v.map((e,a)=>(0,t.jsx)("button",{type:"button",onClick:()=>{p(e),N.current?.focus()},className:"text-[10px] px-2 py-0.5 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded hover:bg-blue-500/30 transition-colors",children:e},a))})]});let S=(0,a.useCallback)(()=>{g(!0)},[]),_=(0,a.useMemo)(()=>null===e||""===e?(0,t.jsx)("span",{className:"text-gray-500 italic text-xs",children:"VacÃ­o"}):"number"===l&&"number"==typeof e?new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e):e,[e,l]);return(0,t.jsxs)("div",{className:(0,c.cn)("group flex items-center justify-between px-2 py-1 rounded hover:bg-white/5 cursor-pointer transition-colors min-h-[32px]",x),onClick:S,children:[(0,t.jsx)("span",{className:"truncate",children:_}),(0,t.jsx)(n,{className:"h-3 w-3 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"})]})}e.s(["InlineEditCell",()=>d],41253)},34754,e=>{"use strict";let t=(0,e.i(71434).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],34754)},60554,e=>{"use strict";let t=(0,e.i(71434).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],60554)},87914,e=>{"use strict";var t=e.i(9964),a=e.i(87312),r=e.i(71434);let s=(0,r.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),l=(0,r.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var i=e.i(5097),o=e.i(83643),n=e.i(41253),c=e.i(60922),d=e.i(68499),x=e.i(60554);function m({isOpen:e,onClose:r,onConfirm:s,title:l,message:i,confirmText:n="Aceptar",cancelText:m="Cancelar",type:u="danger"}){let[h,g]=(0,a.useState)(!1);if((0,a.useEffect)(()=>(g(!0),()=>g(!1)),[]),!e||!h)return null;let b=()=>{switch(u){case"danger":return"text-red-400";case"warning":return"text-yellow-400";default:return"text-blue-400"}},p=(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(8px)",zIndex:9999,position:"fixed",top:0,left:0,right:0,bottom:0},onClick:r,children:(0,t.jsxs)("div",{className:"relative w-full max-w-md rounded-2xl p-6 shadow-2xl",style:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:`1px solid ${(()=>{switch(u){case"danger":return"border-red-500/50";case"warning":return"border-yellow-500/50";default:return"border-blue-500/50"}})().replace("/50","/30")}`,boxShadow:"0 8px 32px 0 rgba(34, 197, 94, 0.3)",animation:"fadeIn 0.2s ease-in-out"},onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{onClick:r,className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-white/10 transition-colors text-gray-400 hover:text-white",children:(0,t.jsx)(d.X,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-1",children:(0,t.jsx)(x.AlertTriangle,{className:`h-6 w-6 ${b()}`})}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)("h3",{className:`text-lg font-semibold ${b()}`,children:l}),(0,t.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",children:i})]})]}),(0,t.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,t.jsx)(o.Button,{onClick:r,variant:"outline",className:"border-gray-500/50 text-gray-300 hover:bg-gray-500/20",children:m}),(0,t.jsx)(o.Button,{onClick:()=>{s(),r()},className:(()=>{switch(u){case"danger":return"bg-red-600 hover:bg-red-500 text-white";case"warning":return"bg-yellow-600 hover:bg-yellow-500 text-white";default:return"bg-blue-600 hover:bg-blue-500 text-white"}})(),children:n})]})]})});return(0,c.createPortal)(p,document.body)}function u({title:e,count:r,description:c,icon:d,bgColor:x,borderColor:u,textColor:h,rows:g,data:b,onCellUpdate:p,onDeleteRow:y,onDeleteAll:f,allowEdit:N=!1,allowDelete:j=!1,mes:v,anio:w,sectionKey:C,esParticularRow:k,esSinHorarioRow:S,esDuplicadoRow:_,esResidenteFormativoRow:F}){let[D,E]=(0,a.useState)(!1),[A,R]=(0,a.useState)(new Set),[M,$]=(0,a.useState)(!1),[z,T]=(0,a.useState)(null);(0,a.useEffect)(()=>{v&&w&&"true"===localStorage.getItem(`expandable_${C}_${v}_${w}`)&&E(!0)},[v,w,C]);let q=e=>{let t=e.toLowerCase().trim();return t.includes("cliente")||t.includes("obra")};return 0===r?null:(0,t.jsxs)("div",{className:"w-full space-y-2",children:[(0,t.jsx)("div",{className:"p-4 rounded-xl border-2 cursor-pointer transition-all hover:opacity-90",style:{background:x,backdropFilter:"blur(20px)",borderColor:u},onClick:()=>{let e=!D;E(e),v&&w&&localStorage.setItem(`expandable_${C}_${v}_${w}`,String(e)),e||R(new Set)},children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",style:{color:h},children:[d,(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-bold text-lg mb-1",children:e}),(0,t.jsx)("div",{className:"text-sm",style:{color:h,opacity:.8},children:c})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[j&&D&&(0,t.jsxs)(t.Fragment,{children:[A.size>0&&(0,t.jsxs)(o.Button,{onClick:e=>{e.stopPropagation(),T({type:"multiple",count:A.size}),$(!0)},size:"sm",variant:"destructive",className:"mr-2",children:[(0,t.jsx)(i.Trash2,{className:"h-4 w-4 mr-1"}),"Eliminar seleccionados (",A.size,")"]}),f&&(0,t.jsxs)(o.Button,{onClick:e=>{e.stopPropagation(),T({type:"all",count:r}),$(!0)},size:"sm",variant:"destructive",className:"mr-2",children:[(0,t.jsx)(i.Trash2,{className:"h-4 w-4 mr-1"}),"Eliminar todos"]})]}),D?(0,t.jsx)(l,{className:"h-6 w-6",style:{color:h}}):(0,t.jsx)(s,{className:"h-6 w-6",style:{color:h}})]})]})}),D&&(0,t.jsx)("div",{className:"rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full border-collapse text-xs",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-white/10",children:[j&&(0,t.jsx)("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap sticky left-0",style:{position:"sticky",top:0,zIndex:12,minWidth:"50px",maxWidth:"50px",background:"rgba(0, 0, 0, 0.8)"},children:(0,t.jsx)("input",{type:"checkbox",checked:A.size===g.length&&g.length>0,onChange:e=>{e.target.checked?R(new Set(g.map((e,t)=>b.rows.findIndex(e=>e===g[t])).filter(e=>-1!==e))):R(new Set)},className:"w-4 h-4 rounded border-gray-500 bg-gray-800 text-green-500 focus:ring-green-500 focus:ring-2",onClick:e=>e.stopPropagation()})}),b.headers.map((e,a)=>(0,t.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap",style:{position:"sticky",top:0,zIndex:10,minWidth:"120px",maxWidth:"200px"},children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"truncate",children:e}),q(e)&&N&&(0,t.jsx)("span",{className:"text-[10px] text-green-400 bg-green-400/20 px-1.5 py-0.5 rounded flex-shrink-0",children:"Editable"})]})},a)),j&&(0,t.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap sticky right-0",style:{position:"sticky",top:0,zIndex:11,minWidth:"60px",maxWidth:"60px"},children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:g.map((e,a)=>{let r=b.rows.findIndex(t=>t===e),s=A.has(r),l="detalle_completo"===C,c=!!l&&!!k&&k(r),d=!!l&&!!S&&S(r),x=!!l&&!!_&&_(r),m=!!l&&!!F&&F(r),u="transparent";return d?u="rgba(239, 68, 68, 0.15)":x?u="rgba(168, 85, 247, 0.15)":c?u="rgba(251, 191, 36, 0.15)":m&&(u="rgba(59, 130, 246, 0.15)"),s&&(u="transparent"===u?"rgba(34, 197, 94, 0.2)":u.replace("0.15","0.25")),(0,t.jsxs)("tr",{className:"border-b transition-colors border-white/5 hover:bg-white/5",style:{backgroundColor:u,borderLeft:s?"3px solid rgba(34, 197, 94, 0.8)":void 0},children:[j&&(0,t.jsx)("td",{className:"px-2 py-1.5 text-center sticky left-0 z-10",style:{minWidth:"50px",maxWidth:"50px",background:"transparent"!==u?u:"rgba(0, 0, 0, 0.5)"},onClick:e=>e.stopPropagation(),children:(0,t.jsx)("input",{type:"checkbox",checked:s,onChange:e=>{let t=new Set(A);e.target.checked?t.add(r):t.delete(r),R(t)},className:"w-4 h-4 rounded border-gray-500 bg-gray-800 text-green-500 focus:ring-green-500 focus:ring-2"})}),b.headers.map((a,s)=>{let l=e[a]??null,i=q(a)&&N;return(0,t.jsx)("td",{className:"px-2 py-1.5 text-xs text-gray-300",style:{minWidth:"120px",maxWidth:"200px"},children:i&&p?(0,t.jsx)(n.InlineEditCell,{value:l||"",onSave:async e=>{await p(r,a,e)},columnName:a}):(0,t.jsx)("span",{className:"truncate block",children:l||"-"})},s)}),j&&y&&(0,t.jsx)("td",{className:"px-2 py-1.5 text-center sticky right-0",style:{background:"transparent"!==u?u:"rgba(0, 0, 0, 0.5)"},children:(0,t.jsx)(o.Button,{onClick:async e=>{e.stopPropagation(),T({type:"single",rowIndex:r}),$(!0)},size:"sm",variant:"ghost",className:"text-red-400 hover:text-red-300 hover:bg-red-500/20",children:(0,t.jsx)(i.Trash2,{className:"h-4 w-4"})})})]},r)})})]})})}),(0,t.jsx)(m,{isOpen:M,onClose:()=>{$(!1),T(null)},onConfirm:async()=>{if(z)try{if("all"===z.type&&f)await f(),R(new Set);else if("multiple"===z.type&&y){for(let e of Array.from(A).sort((e,t)=>t-e))await y(e);R(new Set)}else if("single"===z.type&&void 0!==z.rowIndex&&y){await y(z.rowIndex);let e=new Set(A);e.delete(z.rowIndex),R(e)}}catch(e){console.error("Error eliminando filas:",e)}},title:"Confirmar eliminaciÃ³n",message:z?.type==="all"?`\xbfEst\xe1 seguro de que desea eliminar todos los ${z.count} registros? Esta acci\xf3n no se puede deshacer.`:z?.type==="multiple"?`\xbfEst\xe1 seguro de que desea eliminar los ${z.count} registros seleccionados? Esta acci\xf3n no se puede deshacer.`:"Â¿EstÃ¡ seguro de que desea eliminar esta fila? Esta acciÃ³n no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar",type:"danger"})]})}var h=e.i(19029),g=e.i(58427);let b=(0,r.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),p=(0,r.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),y=(0,r.default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var f=e.i(97451),N=e.i(74786);function j({data:e,especialidad:r,onCellUpdate:s,onDeleteRow:l,liquidacionId:i,mes:o,anio:n}){let[c,d]=(0,a.useState)(e.rows),[x,m]=(0,a.useState)({}),[j,v]=(0,a.useState)([]),[w,C]=(0,a.useState)(!1),k=(0,a.useRef)(e.rows.length);(0,a.useEffect)(()=>{e.rows.length!==k.current&&(k.current=e.rows.length,d(e.rows))},[e.rows.length]),(0,a.useEffect)(()=>{if(!r){v([]),C(!1);return}!async function(){try{if(C(!0),!r)return;let{data:e,error:t}=await N.supabase.from("medicos").select("*").eq("especialidad",r).eq("activo",!0);if(t)throw t;v(e||[])}catch(e){console.error("Error loading mÃ©dicos:",e)}finally{C(!1)}}()},[r]);let S=(0,a.useMemo)(()=>{let e=new Map;return j.forEach(t=>{let a=t.nombre.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();e.set(a,t);let r=t.nombre.split(",").map(e=>e.trim());if(r.length>0){let a=r[0].toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();a&&!e.has(a)&&e.set(a,t)}}),e},[j]),_=(0,a.useCallback)(e=>{if(!e||"string"!=typeof e)return null;let t=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();if(S.has(t))return S.get(t)||null;for(let[e,a]of S.entries())if(t.includes(e)||e.includes(t))return a;return null},[S]),F=(0,a.useMemo)(()=>{let t=new Set,a=e.headers.findIndex(e=>{let t=e.toLowerCase().trim();return"cliente"===t||t.includes("obra social")||"obra social"===t||"obra"===t||t.includes("obra")&&t.includes("social")});if(-1===a)return console.warn("[ExcelDataTable] No se encontrÃ³ columna de Cliente/Obra Social"),t;let r=e.headers[a];return c.forEach((e,a)=>{let s=e[r];(0,f.esParticular)(s)&&t.add(a)}),console.log(`[ExcelDataTable] Filas sin obra social detectadas: ${t.size}`),t},[c,e.headers]),D=(0,a.useMemo)(()=>{let t=new Set;return c.forEach((a,r)=>{(0,f.tieneHorario)(a,e.headers)||t.add(r)}),t},[c,e.headers]),E=(0,a.useMemo)(()=>(0,f.obtenerIndicesDuplicados)(c,e.headers),[c,e.headers]),A=(0,a.useMemo)(()=>{let t=new Set;if(!r||0===j.length||w)return t;let a=e.headers.findIndex(e=>{let t=e.toLowerCase().trim();return"responsable"===t||t.includes("responsable")||t.includes("medico")}),s=e.headers.findIndex(e=>{let t=e.toLowerCase().trim();return"fecha"===t||t.includes("fecha")||t.includes("fecha visita")}),l=e.headers.findIndex(e=>{let t=e.toLowerCase().trim();return t.includes("hora")||t.includes("horario")||t.includes("inicio")});return -1===a||-1===s||-1===l||c.forEach((r,i)=>{let o=r[e.headers[a]],n=r[e.headers[s]],c=r[e.headers[l]],d=_(o);d&&d.es_residente&&(0,f.esResidenteHorarioFormativo)(n,c,d.es_residente)&&t.add(i)}),t},[c,e.headers,r,j,w,_]),R=F.size,M=D.size,$=E.size,z=A.size,T=(0,a.useCallback)(async t=>{if(l){await l(t);let a=c.filter((e,a)=>a!==t);d(a),e.rows=a}else{let a=c.filter((e,a)=>a!==t);d(a),e.rows=a}},[c,e,l]),q=(0,a.useCallback)(async t=>{if(l)for(let e of Array.from(t).sort((e,t)=>t-e))await l(e);else{let a=c.filter((e,a)=>!t.has(a));d(a),e.rows=a}},[c,e,l]),I=(0,a.useMemo)(()=>c.filter((e,t)=>F.has(t)),[c,F]),P=(0,a.useMemo)(()=>c.filter((e,t)=>D.has(t)),[c,D]),L=(0,a.useMemo)(()=>c.filter((e,t)=>E.has(t)),[c,E]),W=(0,a.useMemo)(()=>c.filter((e,t)=>A.has(t)),[c,A]),B=(0,a.useCallback)(async()=>{await q(D)},[D,q]),G=(0,a.useCallback)(async()=>{await q(E)},[E,q]),O=(0,a.useCallback)(async()=>{await q(A)},[A,q]);return(0,t.jsxs)("div",{className:"w-full space-y-4",children:[e.periodo&&(0,t.jsx)("div",{className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-green-400",children:[(0,t.jsx)(h.CheckCircle2,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-semibold",children:"PerÃ­odo analizado:"}),(0,t.jsxs)("span",{className:"text-white",children:[e.periodo.desde," - ",e.periodo.hasta]})]})}),(0,t.jsx)(u,{title:`âš ï¸ ${R} registro${R>1?"s":""} sin obra social detectado${R>1?"s":""}`,count:R,description:'Estos registros deben ser revisados. Si son pacientes particulares, edite la columna "Cliente" y agregue: "042 - PARTICULARES"',icon:(0,t.jsx)(g.AlertCircle,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(251, 191, 36, 0.15)",borderColor:"rgba(251, 191, 36, 0.5)",textColor:"#fbbf24",rows:I,data:e,onCellUpdate:s,allowEdit:!0,mes:o,anio:n,sectionKey:"sin_obra_social"}),(0,t.jsx)(u,{title:`âš ï¸ ${M} registro${M>1?"s":""} sin horario de inicio detectado${M>1?"s":""}`,count:M,description:"Estos registros indican que el paciente no se atendiÃ³. Deben ser eliminados.",icon:(0,t.jsx)(b,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",textColor:"#ef4444",rows:P,data:e,onDeleteRow:T,onDeleteAll:B,allowDelete:!0,mes:o,anio:n,sectionKey:"sin_horario"}),(0,t.jsx)(u,{title:`âš ï¸ ${$} registro${$>1?"s":""} duplicado${$>1?"s":""} detectado${$>1?"s":""}`,count:$,description:"Se detectaron filas completamente iguales (misma fecha, misma hora, mismo todo). Revise y elimine los duplicados si es necesario.",icon:(0,t.jsx)(g.AlertCircle,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(168, 85, 247, 0.15)",borderColor:"rgba(168, 85, 247, 0.5)",textColor:"#a855f7",rows:L,data:e,onDeleteRow:T,onDeleteAll:G,allowDelete:!0,mes:o,anio:n,sectionKey:"duplicados"}),(0,t.jsx)(u,{title:`â„¹ï¸ ${z} consulta${z>1?"s":""} de residente${z>1?"s":""} en horario formativo detectada${z>1?"s":""}`,count:z,description:"Estas consultas son de residentes realizadas entre lunes a sÃ¡bado de 07:00 a 15:00. NO se deben pagar segÃºn las reglas del sistema.",icon:(0,t.jsx)(p,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",textColor:"#3b82f6",rows:W,data:e,onDeleteRow:T,onDeleteAll:O,allowDelete:!0,mes:o,anio:n,sectionKey:"residente_formativo"}),(0,t.jsx)(u,{title:`ðŸ“Š Ver detalle completo (${c.length} registros)`,count:c.length,description:"Muestra todos los registros del Excel para revisiÃ³n completa con colores segÃºn reglas.",icon:(0,t.jsx)(y,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(34, 197, 94, 0.15)",borderColor:"rgba(34, 197, 94, 0.5)",textColor:"#22c55e",rows:c,data:e,onCellUpdate:s,onDeleteRow:T,allowEdit:!0,allowDelete:!0,mes:o,anio:n,sectionKey:"detalle_completo",esParticularRow:e=>F.has(e),esSinHorarioRow:e=>D.has(e),esDuplicadoRow:e=>E.has(e),esResidenteFormativoRow:e=>A.has(e)}),(0,t.jsxs)("div",{className:"text-sm text-gray-400",children:["Total de filas: ",(0,t.jsx)("span",{className:"text-green-400 font-semibold",children:c.length})," â€¢ ","Columnas: ",(0,t.jsx)("span",{className:"text-green-400 font-semibold",children:e.headers.length}),R>0&&(0,t.jsxs)(t.Fragment,{children:[" â€¢ ","Sin obra social: ",(0,t.jsx)("span",{className:"text-yellow-400 font-semibold",children:R})]}),M>0&&(0,t.jsxs)(t.Fragment,{children:[" â€¢ ","Sin horario: ",(0,t.jsx)("span",{className:"text-red-400 font-semibold",children:M})]}),$>0&&(0,t.jsxs)(t.Fragment,{children:[" â€¢ ","Duplicados: ",(0,t.jsx)("span",{className:"text-purple-400 font-semibold",children:$})]}),z>0&&(0,t.jsxs)(t.Fragment,{children:[" â€¢ ","Residente formativo: ",(0,t.jsx)("span",{className:"text-blue-400 font-semibold",children:z})]})]})]})}e.s(["ExcelDataTable",()=>j],87914)},17462,e=>{"use strict";var t=e.i(9964),a=e.i(87312),r=e.i(7735),s=e.i(74786),l=e.i(97451);async function i(e,t){let{data:a}=await s.supabase.from("liquidaciones_guardia").select("id").eq("especialidad","GinecologÃ­a").eq("mes",e).eq("anio",t).single();if(!a||!a.id)return[];let r=a.id,{data:i}=await s.supabase.from("detalle_guardia").select("*").eq("liquidacion_id",r);if(!i||0===i.length)return[];let{data:o}=await s.supabase.from("valores_consultas_obra_social").select("*").eq("tipo_consulta","CONSULTA GINECOLOGICA").eq("mes",e).eq("anio",t);if(!o||0===o.length)return[];let n=new Map;o.forEach(e=>{n.set(e.obra_social,e.valor)});let c=new Map;return i.forEach(e=>{let t=!0===e.medico_es_residente;if((0,l.esResidenteHorarioFormativo)(e.fecha,e.hora,t))return;let a=e.obra_social||"PARTICULARES",r=e.medico_nombre||"Desconocido",s=e.medico_id||"sin-id",i=`${s}|${a}`,o=n.get(a)||0;if(c.has(i)){let e=c.get(i);e.cantidad+=1,e.total=e.cantidad*e.valor_unitario}else c.set(i,{medico_id:e.medico_id,medico_nombre:r,obra_social:a,cantidad:1,valor_unitario:o,total:o})}),Array.from(c.values()).sort((e,t)=>e.medico_nombre!==t.medico_nombre?e.medico_nombre.localeCompare(t.medico_nombre):e.obra_social.localeCompare(t.obra_social))}async function o(e,t){let a=await i(e,t),r=new Map;return a.forEach(e=>{let t=e.medico_id||"sin-id",a=e.medico_nombre;if(r.has(t)){let a=r.get(t);a.cantidad+=e.cantidad,a.total_bruto+=e.total,a.retencion_20=.2*a.total_bruto,a.total_neto=a.total_bruto-a.retencion_20}else{let s=e.total,l=.2*s;r.set(t,{medico_id:e.medico_id,medico_nombre:a,cantidad:e.cantidad,total_bruto:s,retencion_20:l,total_neto:s-l})}}),Array.from(r.values()).sort((e,t)=>e.medico_nombre.localeCompare(t.medico_nombre))}var n=e.i(99093),c=e.i(89174);let d=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],x=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];var m=e.i(83643),u=e.i(34754),h=e.i(81981),g=e.i(23164),b=e.i(71434);let p=(0,b.default)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),y=(0,b.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var f=e.i(47188),N=e.i(87914);async function j(e,t,a){try{let{data:r,error:s}=await t.from("detalle_guardia").select("id, fecha, hora, paciente, obra_social, medico_nombre, fila_excel").eq("liquidacion_id",e).order("fila_excel",{ascending:!0,nullsFirst:!1});if(s)return console.error("Error cargando detalles:",s),null;if(!r||0===r.length)return null;return function(e,t){if(0===e.length)return{periodo:null,headers:t||[],rows:[]};let a=[...e].sort((e,t)=>(e.fila_excel||0)-(t.fila_excel||0)),r=t||["Fecha","Hora","Paciente","Obra Social","Responsable"],s=a.map(e=>{let t={};return r.forEach(a=>{let r=a.toLowerCase().trim();if(r.includes("fecha")||r.includes("date"))if(e.fecha){let r=new Date(e.fecha);if(isNaN(r.getTime()))t[a]=e.fecha;else{let e=String(r.getDate()).padStart(2,"0"),s=String(r.getMonth()+1).padStart(2,"0"),l=r.getFullYear();t[a]=`${e}/${s}/${l}`}}else t[a]=null;else r.includes("hora")||r.includes("horario")?t[a]=e.hora||null:r.includes("paciente")?t[a]=e.paciente||null:r.includes("obra")||r.includes("cliente")?t[a]=e.obra_social||null:r.includes("responsable")||r.includes("medico")?t[a]=e.medico_nombre||null:t[a]=null}),t}),l=null;if(a.length>0){let e=a.map(e=>e.fecha?new Date(e.fecha):null).filter(e=>null!==e&&!isNaN(e.getTime())).sort((e,t)=>e.getTime()-t.getTime());if(e.length>0){let t=e[0],a=e[e.length-1],r=e=>{let t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),r=e.getFullYear();return`${t}/${a}/${r}`};l={desde:r(t),hasta:r(a)}}}return{periodo:l,headers:r,rows:s}}(r,a)}catch(e){return console.error("Error en cargarExcelDataDesdeBD:",e),null}}let v=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}];function w(){let e=(0,r.useRouter)(),[b,w]=(0,a.useState)(new Date().getMonth()+1),[k,S]=(0,a.useState)(new Date().getFullYear()),[_,F]=(0,a.useState)(new Map),[D,E]=(0,a.useState)([]),[A,R]=(0,a.useState)([]),[M,$]=(0,a.useState)(!1),[z,T]=(0,a.useState)(!1),[q,I]=(0,a.useState)("medicos"),[P,L]=(0,a.useState)(null),[W,B]=(0,a.useState)(null),[G,O]=(0,a.useState)(null),[H,V]=(0,a.useState)(!1);async function U(){V(!0);try{let{data:e,error:t}=await s.supabase.from("liquidaciones_guardia").select("*").eq("especialidad","GinecologÃ­a").eq("mes",b).eq("anio",k).single();if(t&&"PGRST116"!==t.code){console.error("Error cargando liquidaciÃ³n:",t),B(null),O(null);return}if(e){O(e);let t=await j(e.id,s.supabase);t?B(t):B(null)}else O(null),B(null)}catch(e){console.error("Error cargando ExcelData:",e),B(null),O(null)}finally{V(!1)}}(0,a.useEffect)(()=>{"historial"===q?ee():"excel"===q?U():Q()},[b,k,q]);let K=(0,a.useRef)(new Map),J=(0,a.useRef)(null),Y=(0,a.useCallback)(async(e,t,a)=>{if(!G||!W)return;let r=e+1;W.rows[e]&&(W.rows[e][t]=a,B({...W}));let s=`${G.id}-${r}-${t}`;K.current.set(s,{liquidacionId:G.id,filaExcel:r,columna:t,valor:a}),J.current&&clearTimeout(J.current),J.current=setTimeout(async()=>{await X()},500)},[G,W]),X=async()=>{if(0===K.current.size||!G)return;let e=Array.from(K.current.values());try{let t=new Map;e.forEach(e=>{t.has(e.filaExcel)||t.set(e.filaExcel,new Map);let a=t.get(e.filaExcel);e.columna.toLowerCase().includes("cliente")||e.columna.toLowerCase().includes("obra")?a.set("obra_social",e.valor):e.columna.toLowerCase().includes("responsable")||e.columna.toLowerCase().includes("medico")?a.set("medico_nombre",e.valor):e.columna.toLowerCase().includes("paciente")&&a.set("paciente",e.valor)});let a=Array.from(t.entries()).map(async([e,t])=>{let a={};t.forEach((e,t)=>{a[t]=e}),a.updated_at=new Date().toISOString();let{error:r}=await s.supabase.from("detalle_guardia").update(a).eq("liquidacion_id",G.id).eq("fila_excel",e);if(r)throw r});await Promise.all(a),K.current.clear()}catch(e){console.error("Error guardando cambios:",e)}},Z=(0,a.useCallback)(async e=>{if(G&&W)try{let{error:t}=await s.supabase.from("detalle_guardia").delete().eq("liquidacion_id",G.id).eq("fila_excel",e+1);if(t)return void console.error("Error eliminando fila:",t);let a=W.rows.filter((t,a)=>a!==e);B({...W,rows:a})}catch(e){console.error("Error eliminando fila:",e)}},[G,W]);async function Q(){$(!0);try{let e=await o(b,k);E(e);let t=await i(b,k),a=new Map;t.forEach(e=>{let t=e.medico_id||"sin-id";a.has(t)||a.set(t,[]),a.get(t).push(e)}),F(a)}catch(e){console.error("Error cargando resÃºmenes:",e)}finally{$(!1)}}async function ee(){T(!0);try{let{data:e,error:t}=await s.supabase.from("liquidaciones_guardia").select("*").eq("especialidad","GinecologÃ­a").order("anio",{ascending:!1}).order("mes",{ascending:!1});if(t)throw t;R(e||[])}catch(e){console.error("Error cargando historial:",e)}finally{T(!1)}}function et(e){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}let ea=Array.from(_.keys()).map(e=>{let t=_.get(e)||[];return t[0]?.medico_nombre||"Desconocido"}).sort();return(0,t.jsx)("div",{className:"min-h-screen p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(m.Button,{onClick:()=>e.push("/ginecologia"),variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,t.jsx)(u.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Volver"]}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-green-400",children:"ResÃºmenes de LiquidaciÃ³n - GinecologÃ­a"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-300",children:"Mes:"}),(0,t.jsx)("select",{value:b,onChange:e=>w(Number(e.target.value)),className:"px-3 py-2 bg-gray-800 border border-green-500/50 rounded-lg text-white focus:border-green-400 focus:outline-none",children:v.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-300",children:"AÃ±o:"}),(0,t.jsx)("input",{type:"number",value:k,onChange:e=>S(Number(e.target.value)),className:"px-3 py-2 bg-gray-800 border border-green-500/50 rounded-lg text-white w-24 focus:border-green-400 focus:outline-none"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 border-b border-gray-700",children:[(0,t.jsx)("button",{onClick:()=>I("medicos"),className:`px-4 py-2 font-semibold transition-colors ${"medicos"===q?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:"Resumen por MÃ©dico"}),(0,t.jsx)("button",{onClick:()=>I("prestadores"),className:`px-4 py-2 font-semibold transition-colors ${"prestadores"===q?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:"Resumen por Prestador"}),(0,t.jsxs)("button",{onClick:()=>I("historial"),className:`px-4 py-2 font-semibold transition-colors flex items-center gap-2 ${"historial"===q?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:[(0,t.jsx)(p,{className:"h-4 w-4"}),"Historial"]}),(0,t.jsxs)("button",{onClick:()=>I("excel"),className:`px-4 py-2 font-semibold transition-colors flex items-center gap-2 ${"excel"===q?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:[(0,t.jsx)(f.FileSpreadsheet,{className:"h-4 w-4"}),"Excel"]})]}),"historial"===q?(0,t.jsx)("div",{className:"space-y-6",children:z?(0,t.jsx)("div",{className:"text-center py-12 text-gray-400",children:"Cargando historial..."}):0===A.length?(0,t.jsxs)("div",{className:"rounded-xl p-8 text-center",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[(0,t.jsx)("div",{className:"text-yellow-400 text-xl font-bold mb-4",children:"No hay liquidaciones procesadas"}),(0,t.jsx)("div",{className:"text-gray-400 mb-6",children:"AÃºn no se ha procesado ningÃºn archivo Excel de GinecologÃ­a."}),(0,t.jsx)(m.Button,{onClick:()=>e.push("/ginecologia"),className:"bg-green-600 hover:bg-green-500 text-white",children:"Ir a GinecologÃ­a"})]}):(0,t.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:"Historial de Liquidaciones"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"PerÃ­odo"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"NÂ° LiquidaciÃ³n"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Archivo"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center text-sm font-semibold text-green-400",children:"Estado"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Consultas"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total Bruto"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total Neto"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Fecha Procesamiento"}),(0,t.jsx)("th",{className:"px-4 py-3 text-center text-sm font-semibold text-green-400",children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:A.map(e=>{let a=e.created_at?new Date(e.created_at).toLocaleDateString("es-AR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",r=v.find(t=>t.value===e.mes)?.label||`Mes ${e.mes}`,s=P===e.id;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,t.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-300 font-medium",children:[r," ",e.anio]}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:e.numero_liquidacion||"-"}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:(0,t.jsx)("div",{className:"max-w-xs truncate",title:e.archivo_nombre||"",children:e.archivo_nombre||"Sin archivo"})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-center",children:(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs font-semibold ${"finalizada"===e.estado?"bg-green-500/20 text-green-400":"procesando"===e.estado?"bg-yellow-500/20 text-yellow-400":"error"===e.estado?"bg-red-500/20 text-red-400":"bg-gray-500/20 text-gray-400"}`,children:e.estado})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:e.total_consultas||0}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:et(e.total_bruto||0)}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right font-semibold",children:et(e.total_neto||0)}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:a}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:(0,t.jsxs)(m.Button,{onClick:()=>{L(s?null:e.id)},variant:"outline",size:"sm",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,t.jsx)(y,{className:"h-4 w-4 mr-1"}),s?"Ocultar":"Ver"]})})]},e.id),s&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:9,className:"px-4 py-4 bg-gray-900/50",children:(0,t.jsx)(C,{liquidacionId:e.id})})})]})})})]})})]})}):"excel"===q?(0,t.jsx)("div",{className:"space-y-6",children:H?(0,t.jsx)("div",{className:"text-center py-12 text-gray-400",children:"Cargando Excel..."}):G?W?(0,t.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:["Excel - ",v.find(e=>e.value===b)?.label||`Mes ${b}`," ",k]}),(0,t.jsx)("p",{className:"text-gray-400 mb-4 text-sm",children:"Los cambios se guardan automÃ¡ticamente. Revisa duplicados, filas sin obra social y sin horario."}),(0,t.jsx)(N.ExcelDataTable,{data:W,especialidad:"GinecologÃ­a",onCellUpdate:Y,onDeleteRow:Z,liquidacionId:G.id,mes:b,anio:k})]}):(0,t.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No se pudo cargar el Excel"}):(0,t.jsxs)("div",{className:"rounded-xl p-8 text-center",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[(0,t.jsx)("div",{className:"text-yellow-400 text-xl font-bold mb-4",children:"No hay liquidaciÃ³n para este perÃ­odo"}),(0,t.jsxs)("div",{className:"text-gray-400 mb-6",children:["No se ha procesado ningÃºn archivo Excel para ",v.find(e=>e.value===b)?.label||`Mes ${b}`," ",k,"."]}),(0,t.jsx)(m.Button,{onClick:()=>e.push("/ginecologia"),className:"bg-green-600 hover:bg-green-500 text-white",children:"Ir a GinecologÃ­a para procesar archivo"})]})}):M?(0,t.jsx)("div",{className:"text-center py-12 text-gray-400",children:"Cargando resÃºmenes..."}):0===_.size&&0===D.length?(0,t.jsxs)("div",{className:"rounded-xl p-8 text-center",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[(0,t.jsx)("div",{className:"text-yellow-400 text-xl font-bold mb-4",children:"No hay datos para el perÃ­odo seleccionado"}),(0,t.jsx)("div",{className:"text-gray-400 mb-6",children:"Para generar resÃºmenes, primero debes:"}),(0,t.jsxs)("ol",{className:"text-left text-gray-300 space-y-2 max-w-md mx-auto mb-6",children:[(0,t.jsxs)("li",{children:["1. Ir a la pÃ¡gina de ",(0,t.jsx)("strong",{className:"text-green-400",children:"GinecologÃ­a"})]}),(0,t.jsx)("li",{children:"2. Subir un archivo Excel con las consultas"}),(0,t.jsx)("li",{children:"3. Confirmar el mes y aÃ±o del perÃ­odo"}),(0,t.jsx)("li",{children:"4. El sistema guardarÃ¡ automÃ¡ticamente los datos"})]}),(0,t.jsx)(m.Button,{onClick:()=>e.push("/ginecologia"),className:"bg-green-600 hover:bg-green-500 text-white",children:"Ir a GinecologÃ­a"})]}):"medicos"===q?(0,t.jsx)("div",{className:"space-y-6",children:0===ea.length?(0,t.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No hay datos para el perÃ­odo seleccionado"}):ea.map(e=>{let a=Array.from(_.keys()).find(t=>{let a=_.get(t)||[];return a[0]?.medico_nombre===e}),r=a&&_.get(a)||[],s=r.reduce((e,t)=>e+t.total,0),i=r.reduce((e,t)=>e+t.cantidad,0);return(0,t.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-green-400",children:e}),(0,t.jsxs)(m.Button,{onClick:()=>{!function({resumenes:e,mes:t,anio:a,medicoNombre:r}){let s=new n.default({orientation:"portrait",unit:"mm",format:"a4"}),i=20,o=(0,l.calcularNumeroLiquidacion)(t,a);s.setFontSize(11),s.setTextColor(34,197,94),s.setFont("helvetica","bold"),s.text("Grow Labs",15,i),s.setFontSize(7.5),s.setTextColor(100,100,100),s.setFont("helvetica","normal"),s.text("Sistema de Liquidaciones de Guardias",15,i+5),i+=15,s.setFontSize(16),s.setTextColor(0,0,0),s.setFont("helvetica","bold"),s.text(r.toUpperCase(),15,i);let x=i+=10;s.setFillColor(240,240,240),s.setDrawColor(200,200,200),s.roundedRect(105,x,90,30,2,2,"FD");let m=x+3.75;s.setFontSize(8.5),s.setTextColor(0,0,0),s.setFont("helvetica","bold"),s.text("Mes:",109.5,m),s.setFont("helvetica","normal"),s.text(d[t-1],151.5,m),m+=7.5,s.setFont("helvetica","bold"),s.text("AÃ±o:",109.5,m),s.setFont("helvetica","normal"),s.text(String(a),151.5,m),m+=7.5,s.setFont("helvetica","bold"),s.text("Liq:",109.5,m),s.setFont("helvetica","normal"),s.text(String(o),151.5,m),m+=7.5,s.setFont("helvetica","bold"),s.text("Generado:",109.5,m),s.setFont("helvetica","normal");let u=new Date().toLocaleDateString("es-AR");s.text(u,151.5,m),i=x+30+10;let h=e.map(e=>[e.obra_social,String(e.cantidad),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(e.valor_unitario),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(e.total)]),g=e.reduce((e,t)=>e+t.cantidad,0),b=e.reduce((e,t)=>e+t.total,0);h.push(["TOTAL",String(g),"",new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(b)]);(0,c.default)(s,{startY:i,head:[["Obra social","Cantidad","Valor unitario","Total"]],body:h,theme:"striped",headStyles:{fillColor:[34,197,94],textColor:[255,255,255],fontStyle:"bold",fontSize:9,halign:"left"},bodyStyles:{fontSize:8,textColor:[0,0,0],cellPadding:2,halign:"left"},columnStyles:{0:{cellWidth:70,fontStyle:"bold"},1:{cellWidth:30,halign:"right"},2:{cellWidth:40,halign:"right"},3:{cellWidth:40,halign:"right",fontStyle:"bold"}},styles:{lineColor:[220,220,220],lineWidth:.1,valign:"middle"},margin:{left:15,right:15},tableWidth:180,showHead:"everyPage",pageBreak:"auto",rowPageBreak:"avoid",didParseCell:e=>{e.row.index===h.length-1&&(e.cell.styles.fillColor=[240,240,240],e.cell.styles.fontStyle="bold")}});let p=s.getNumberOfPages();for(let e=1;e<=p;e++)s.setPage(e),s.setFontSize(7),s.setTextColor(150,150,150),s.setFont("helvetica","italic"),s.text(`P\xe1gina ${e} de ${p} - Powered by Grow Labs ðŸŒ±`,105,287,{align:"center"});let y=`Resumen_${r.replace(/[^a-zA-Z0-9]/g,"_")}_${d[t-1]}_${a}.pdf`;s.save(y)}({resumenes:r,mes:b,anio:k,medicoNombre:e})},variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,t.jsx)(h.FileDown,{className:"h-4 w-4 mr-2"}),"Exportar PDF"]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Obra social"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Cantidad"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Valor unitario"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total"})]})}),(0,t.jsxs)("tbody",{children:[r.map((e,a)=>(0,t.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:e.obra_social}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:e.cantidad}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:et(e.valor_unitario)}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right font-semibold",children:et(e.total)})]},a)),(0,t.jsxs)("tr",{className:"bg-gray-800/50 font-bold",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400",children:"TOTAL"}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:i}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right"}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:et(s)})]})]})]})})]},e)})}):(0,t.jsx)("div",{className:"space-y-6",children:0===D.length?(0,t.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No hay datos para el perÃ­odo seleccionado"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex justify-end mb-4",children:(0,t.jsxs)(m.Button,{onClick:function(){!function({resumenes:e,mes:t,anio:a}){let r=new n.default({orientation:"portrait",unit:"mm",format:"a4"}),s=20,i=(0,l.calcularNumeroLiquidacion)(t,a);r.setFontSize(11),r.setTextColor(34,197,94),r.setFont("helvetica","bold"),r.text("Grow Labs",15,s),r.setFontSize(7.5),r.setTextColor(100,100,100),r.setFont("helvetica","normal"),r.text("Sistema de Liquidaciones de Guardias",15,s+5),s+=15,r.setFontSize(16),r.setTextColor(0,0,0),r.setFont("helvetica","bold"),r.text("Guardia GinecolÃ³gica",15,s),r.setFontSize(12),r.setTextColor(100,100,100),r.setFont("helvetica","normal"),r.text(`${x[t-1]} ${a}`,15,s+7);let o=s+=15;r.setFillColor(240,240,240),r.setDrawColor(200,200,200),r.roundedRect(105,o,90,22.5,2,2,"FD");let d=o+3.75;r.setFontSize(8.5),r.setTextColor(0,0,0),r.setFont("helvetica","bold"),r.text("Mes:",109.5,d),r.setFont("helvetica","normal"),r.text(x[t-1],151.5,d),d+=7.5,r.setFont("helvetica","bold"),r.text("AÃ±o:",109.5,d),r.setFont("helvetica","normal"),r.text(String(a),151.5,d),d+=7.5,r.setFont("helvetica","bold"),r.text("Liq:",109.5,d),r.setFont("helvetica","normal"),r.text(String(i),151.5,d),s=o+22.5+10;let m=e.map(e=>[e.medico_nombre,String(e.cantidad),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(e.total_bruto),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(e.retencion_20),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(e.total_neto)]),u=e.reduce((e,t)=>e+t.cantidad,0),h=e.reduce((e,t)=>e+t.total_bruto,0),g=e.reduce((e,t)=>e+t.retencion_20,0),b=e.reduce((e,t)=>e+t.total_neto,0);m.push(["Total general",String(u),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(h),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(g),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(b)]);(0,c.default)(r,{startY:s,head:[["Prestador","Cantidad","Total bruto","RetenciÃ³n 20%","Total Neto"]],body:m,theme:"striped",headStyles:{fillColor:[34,197,94],textColor:[255,255,255],fontStyle:"bold",fontSize:9,halign:"left"},bodyStyles:{fontSize:8,textColor:[0,0,0],cellPadding:2,halign:"left"},columnStyles:{0:{cellWidth:60,fontStyle:"bold"},1:{cellWidth:25,halign:"right"},2:{cellWidth:35,halign:"right"},3:{cellWidth:30,halign:"right"},4:{cellWidth:30,halign:"right",fontStyle:"bold"}},styles:{lineColor:[220,220,220],lineWidth:.1,valign:"middle"},margin:{left:15,right:15},tableWidth:180,showHead:"everyPage",pageBreak:"auto",rowPageBreak:"avoid",didParseCell:e=>{e.row.index===m.length-1&&(e.cell.styles.fillColor=[240,240,240],e.cell.styles.fontStyle="bold")}});let p=r.getNumberOfPages();for(let e=1;e<=p;e++)r.setPage(e),r.setFontSize(7),r.setTextColor(150,150,150),r.setFont("helvetica","italic"),r.text(`P\xe1gina ${e} de ${p} - Powered by Grow Labs ðŸŒ±`,105,287,{align:"center"});let y=`Resumen_Prestadores_${x[t-1]}_${a}.pdf`;r.save(y)}({resumenes:D,mes:b,anio:k})},variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,t.jsx)(g.Download,{className:"h-4 w-4 mr-2"}),"Exportar PDF Completo"]})}),(0,t.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:"Resumen por Prestador"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Prestador"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Cantidad"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total bruto"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"RetenciÃ³n 20%"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total Neto"})]})}),(0,t.jsxs)("tbody",{children:[D.map((e,a)=>(0,t.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 font-medium",children:e.medico_nombre}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:e.cantidad}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:et(e.total_bruto)}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:et(e.retencion_20)}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right font-semibold",children:et(e.total_neto)})]},a)),(0,t.jsxs)("tr",{className:"bg-gray-800/50 font-bold",children:[(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400",children:"Total general"}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:D.reduce((e,t)=>e+t.cantidad,0)}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:et(D.reduce((e,t)=>e+t.total_bruto,0))}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:et(D.reduce((e,t)=>e+t.retencion_20,0))}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:et(D.reduce((e,t)=>e+t.total_neto,0))})]})]})]})})]})]})})]})})}function C({liquidacionId:e}){let[r,l]=(0,a.useState)([]),[i,o]=(0,a.useState)(!1);async function n(){o(!0);try{let{data:t,error:a}=await s.supabase.from("detalle_guardia").select("*").eq("liquidacion_id",e).order("fecha",{ascending:!0}).order("hora",{ascending:!0}).limit(100);if(a)throw a;l(t||[])}catch(e){console.error("Error cargando detalles:",e)}finally{o(!1)}}function c(e){return e?new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(e):"$0.00"}return((0,a.useEffect)(()=>{n()},[e]),i)?(0,t.jsx)("div",{className:"text-center py-4 text-gray-400",children:"Cargando detalles..."}):0===r.length?(0,t.jsx)("div",{className:"text-center py-4 text-gray-400",children:"No hay detalles disponibles"}):(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-green-400 mb-3",children:["Detalle de Consultas (",r.length," registros)"]}),(0,t.jsx)("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{className:"sticky top-0 bg-gray-900",children:(0,t.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,t.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"Fecha"}),(0,t.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"Hora"}),(0,t.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"MÃ©dico"}),(0,t.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"Paciente"}),(0,t.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"Obra Social"}),(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-green-400",children:"Monto Facturado"}),(0,t.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-green-400",children:"Importe Calculado"}),(0,t.jsx)("th",{className:"px-3 py-2 text-center text-xs font-semibold text-green-400",children:"Horario Formativo"})]})}),(0,t.jsx)("tbody",{children:r.map(e=>{var a;return(0,t.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/30",children:[(0,t.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:(a=e.fecha)?new Date(a).toLocaleDateString("es-AR"):"-"}),(0,t.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:e.hora||"-"}),(0,t.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:e.medico_nombre||"-"}),(0,t.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:e.paciente||"-"}),(0,t.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:e.obra_social||"-"}),(0,t.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300 text-right",children:c(e.monto_facturado)}),(0,t.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300 text-right font-semibold",children:c(e.importe_calculado)}),(0,t.jsx)("td",{className:"px-3 py-2 text-xs text-center",children:e.es_horario_formativo?(0,t.jsx)("span",{className:"text-yellow-400",children:"SÃ­"}):(0,t.jsx)("span",{className:"text-gray-500",children:"No"})})]},e.id)})})]})}),r.length>=100&&(0,t.jsx)("div",{className:"mt-2 text-xs text-gray-400 text-center",children:"Mostrando los primeros 100 registros"})]})}e.s(["default",()=>w],17462)},44557,e=>{e.v(t=>Promise.all(["static/chunks/50947de1fb5100bc.js"].map(t=>e.l(t))).then(()=>t(25772)))},18454,e=>{e.v(t=>Promise.all(["static/chunks/46ea109e3f7ee3dc.js"].map(t=>e.l(t))).then(()=>t(32694)))},26753,e=>{e.v(t=>Promise.all(["static/chunks/7bd0dee9ec340940.js"].map(t=>e.l(t))).then(()=>t(90015)))}]);