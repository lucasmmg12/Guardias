(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,41253,e=>{"use strict";var a=e.i(9964),r=e.i(87312),l=e.i(7987),s=e.i(83643),t=e.i(71434);let o=(0,t.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var i=e.i(68499);let n=(0,t.default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var c=e.i(97451);function d({value:e,type:t="text",onSave:d,className:u,isEditable:p=!0,columnName:m}){let[b,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)(e??""),[f,v]=(0,r.useState)(!1),y=(0,r.useRef)(null),N=(0,r.useMemo)(()=>m?.toLowerCase().trim()==="cliente",[m]),j=(0,r.useMemo)(()=>N?(0,c.obtenerSugerenciasObraSocial)(String(e)):[],[N,e]);(0,r.useEffect)(()=>{g(e??"")},[e]),(0,r.useEffect)(()=>{b&&y.current&&y.current.focus()},[b]);let w=(0,r.useCallback)(async()=>{if(h===e)return void x(!1);v(!0);try{await d(h),x(!1)}catch(e){console.error("Error saving:",e)}finally{v(!1)}},[h,e,d]),C=(0,r.useCallback)(()=>{g(e??""),x(!1)},[e]),_=(0,r.useCallback)(e=>{"Enter"===e.key?w():"Escape"===e.key&&C()},[w,C]);if(!p)return(0,a.jsx)("div",{className:(0,c.cn)("px-2 py-1",u),children:e});if(b)return(0,a.jsxs)("div",{className:"flex flex-col gap-1 animate-in fade-in zoom-in-95 duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(l.Input,{ref:y,type:t,value:h,onChange:e=>g("number"===t?Number(e.target.value):e.target.value),onKeyDown:_,disabled:f,className:"h-8 min-w-[100px] bg-gray-800 border-green-500/50 focus:border-green-400 text-white",placeholder:N?"Ingrese obra social o código":void 0}),(0,a.jsx)(s.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 text-green-400 hover:text-green-300 hover:bg-green-500/20",onClick:w,disabled:f,children:(0,a.jsx)(o,{className:"h-4 w-4"})}),(0,a.jsx)(s.Button,{size:"icon",variant:"ghost",className:"h-8 w-8 text-red-400 hover:text-red-300 hover:bg-red-500/20",onClick:C,disabled:f,children:(0,a.jsx)(i.X,{className:"h-4 w-4"})})]}),N&&j.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:j.map((e,r)=>(0,a.jsx)("button",{type:"button",onClick:()=>{g(e),y.current?.focus()},className:"text-[10px] px-2 py-0.5 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded hover:bg-blue-500/30 transition-colors",children:e},r))})]});let S=(0,r.useCallback)(()=>{x(!0)},[]),E=(0,r.useMemo)(()=>null===e||""===e?(0,a.jsx)("span",{className:"text-gray-500 italic text-xs",children:"Vacío"}):"number"===t&&"number"==typeof e?new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e):e,[e,t]);return(0,a.jsxs)("div",{className:(0,c.cn)("group flex items-center justify-between px-2 py-1 rounded hover:bg-white/5 cursor-pointer transition-colors min-h-[32px]",u),onClick:S,children:[(0,a.jsx)("span",{className:"truncate",children:E}),(0,a.jsx)(n,{className:"h-3 w-3 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"})]})}e.s(["InlineEditCell",()=>d],41253)},37882,e=>{"use strict";let a=(0,e.i(71434).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],37882)},4601,e=>{"use strict";var a=e.i(9964),r=e.i(87312),l=e.i(74786),s=e.i(8674),t=e.i(41253),o=e.i(83643),i=e.i(71434);let n=(0,i.default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),c=(0,i.default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);var d=e.i(37882);let u=(0,i.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),p=(0,i.default)("copy-check",[["path",{d:"m12 15 2 2 4-4",key:"2c609p"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var m=e.i(60661),b=e.i(38431);let x=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}],h=["CONSULTA","CONSULTA DE GUARDIA CLINIC","CONSULTA PEDIATRICA Y NEONATAL","CONSULTA DE GUARDIA PEDIATRICA","CONSULTA GINECOLOGICA","CONSULTA DE GUARDIA GINECOLOGICA","CONSULTA EN INTERNADOS","INTERCONSULTAS","CONSULTA CARDIOLOGICA","E.C.G."];function g(){let[e,i]=(0,r.useState)(new Date().getMonth()+1),[g,f]=(0,r.useState)(new Date().getFullYear()),[v,y]=(0,r.useState)([]),[N,j]=(0,r.useState)([]),[w,C]=(0,r.useState)(!1),[_,S]=(0,r.useState)(!1),[E,A]=(0,r.useState)(!1),[k,I]=(0,r.useState)(0);async function O(){try{C(!0);let{data:a,error:r}=await l.supabase.from("valores_consultas_obra_social").select("*").eq("mes",e).eq("anio",g).order("obra_social",{ascending:!0});if(r)throw r;let s=a||[];y(s);let t=[...new Set(s.map(e=>e.obra_social))];j(t)}catch(e){console.error("Error cargando valores:",e)}finally{C(!1)}}async function L(a){try{C(!0);let r=await a.arrayBuffer(),s=b.read(r,{type:"array"}),t=s.SheetNames[0],o=s.Sheets[t],i=[],n=b.utils.decode_range(o["!ref"]||"A1");for(let e=0;e<=n.e.c;e++){let a=o[b.utils.encode_cell({r:1,c:e})];a&&a.v&&i.push(String(a.v).trim())}let c=i.findIndex(e=>e.toLowerCase().includes("obra social")||e.toLowerCase().includes("prepaga")),d=i.findIndex(e=>e.toLowerCase().includes("vigencia"));if(-1===c)return void alert('No se encontró la columna "OBRA SOCIAL / PREPAGA" en el archivo');let u=[];for(let a=2;a<=n.e.r;a++){let r=b.utils.encode_cell({r:a,c:c}),l=o[r]?.v;if(!l)continue;let s=b.utils.encode_cell({r:a,c:d}),t=null;if(o[s]){let e=o[s].v;if(e instanceof Date)t=e.toISOString().split("T")[0];else if("number"==typeof e){let a=b.SSF.parse_date_code(e);a&&(t=`${a.y}-${String(a.m).padStart(2,"0")}-${String(a.d).padStart(2,"0")}`)}else if("string"==typeof e){let a=e.split("/");3===a.length&&(t=`${a[2]}-${a[1]}-${a[0]}`)}}i.forEach((r,s)=>{if(s===c||s===d)return;let i=o[b.utils.encode_cell({r:a,c:s})];if(!i)return;let n=null;if("number"==typeof i.v)n=i.v;else if("string"==typeof i.v){let e=i.v.replace(/[$,\s]/g,"").trim(),a=parseFloat(e);isNaN(a)||(n=a)}null!==n&&n>0&&u.push({obra_social:String(l).trim(),tipo_consulta:r.trim(),valor:n,vigencia:t,mes:e,anio:g})})}if(await l.supabase.from("valores_consultas_obra_social").delete().eq("mes",e).eq("anio",g),u.length>0){let{error:e}=await l.supabase.from("valores_consultas_obra_social").insert(u);if(e)throw e}await O(),S(!1),alert(`Se importaron ${u.length} valores correctamente`)}catch(e){console.error("Error importando Excel:",e),alert("Error al importar el archivo Excel: "+(e instanceof Error?e.message:"Error desconocido"))}finally{C(!1)}}async function T(){try{C(!0);let a=e-1,r=g;0===a&&(a=12,r=g-1);let{data:s,error:t}=await l.supabase.from("valores_consultas_obra_social").select("*").eq("mes",a).eq("anio",r);if(t)throw t;let o=s||[];if(0===o.length)return void alert("No hay valores en el mes anterior para copiar");await l.supabase.from("valores_consultas_obra_social").delete().eq("mes",e).eq("anio",g);let i=o.map(a=>({obra_social:a.obra_social,tipo_consulta:a.tipo_consulta,valor:E?Number((a.valor*(1+k/100)).toFixed(2)):a.valor,vigencia:a.vigencia,mes:e,anio:g})),{error:n}=await l.supabase.from("valores_consultas_obra_social").insert(i);if(n)throw n;await O(),alert(`Se copiaron ${i.length} valores desde ${x[a-1].label} ${r}`)}catch(e){console.error("Error copiando desde mes anterior:",e),alert("Error al copiar valores: "+(e instanceof Error?e.message:"Error desconocido"))}finally{C(!1)}}async function U(){let a=prompt('Ingrese el nombre de la obra social (ej: "001 - PROVINCIA"):');if(a&&a.trim())try{let{data:r}=await l.supabase.from("valores_consultas_obra_social").select("id").eq("obra_social",a.trim()).eq("mes",e).eq("anio",g).limit(1);if(r&&r.length>0)return void alert("Esta obra social ya existe para el mes y año seleccionados");let s=h.map(r=>({obra_social:a.trim(),tipo_consulta:r,valor:0,vigencia:null,mes:e,anio:g})),{error:t}=await l.supabase.from("valores_consultas_obra_social").insert(s);if(t)throw t;await O(),alert("Obra social agregada correctamente")}catch(e){console.error("Error agregando obra social:",e),alert("Error al agregar obra social: "+(e instanceof Error?e.message:"Error desconocido"))}}async function M(a,r,s){try{let{error:t}=await l.supabase.from("valores_consultas_obra_social").update({valor:s}).eq("obra_social",a).eq("tipo_consulta",r).eq("mes",e).eq("anio",g);if(t)throw t;await O()}catch(e){throw console.error("Error actualizando valor:",e),e}}(0,r.useEffect)(()=>{O()},[e,g]);let R=N.map(e=>{let a={obra_social:e};return h.forEach(r=>{let l=v.find(a=>a.obra_social===e&&a.tipo_consulta===r);a[r]=l?.valor||0}),a});return(0,a.jsx)("div",{className:"min-h-screen p-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h1",{className:"text-3xl font-bold text-green-400",children:"Valores de Consultas por Obra Social"})}),(0,a.jsx)("div",{className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400",children:[(0,a.jsx)(n,{className:"h-5 w-5"}),(0,a.jsx)(c,{className:"h-4 w-4"})]}),(0,a.jsxs)("div",{className:"flex-1 text-sm text-gray-300 space-y-1",children:[(0,a.jsx)("p",{className:"font-semibold text-green-400 mb-2",children:"¿Cómo funcionan los valores mensuales?"}),(0,a.jsxs)("ul",{className:"space-y-1 list-disc list-inside",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Primer mes:"}),' Importe el archivo Excel con los valores (botón "Importar Excel")']}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Meses siguientes:"}),' Use "Copiar desde mes anterior" o "Copiar con aumento %"']}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Histórico:"})," Cada mes mantiene sus propios valores para consultas históricas"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Edición:"})," Puede editar valores haciendo clic en la celda"]})]})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-300",children:"Mes a gestionar:"}),(0,a.jsx)("select",{value:e,onChange:e=>i(Number(e.target.value)),className:"px-3 py-2 bg-gray-800 border border-green-500/50 rounded-lg text-white focus:border-green-400 focus:outline-none",children:x.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-300",children:"Año:"}),(0,a.jsx)("input",{type:"number",value:g,onChange:e=>f(Number(e.target.value)),className:"px-3 py-2 bg-gray-800 border border-green-500/50 rounded-lg text-white w-24 focus:border-green-400 focus:outline-none"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,a.jsxs)(o.Button,{onClick:U,className:"bg-green-600 hover:bg-green-500 text-white",disabled:w,children:[(0,a.jsx)(d.Plus,{className:"h-4 w-4 mr-2"}),"Crear Obra Social"]}),(0,a.jsxs)(o.Button,{onClick:()=>S(!_),variant:"outline",className:"border-purple-500/50 text-purple-400 hover:bg-purple-500/20",disabled:w,children:[(0,a.jsx)(m.Upload,{className:"h-4 w-4 mr-2"}),"Importar Excel"]}),(0,a.jsxs)(o.Button,{onClick:T,variant:"outline",className:`border-purple-500/50 text-purple-400 hover:bg-purple-500/20 ${!E?"bg-purple-500/20":""}`,disabled:w,children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),"Copiar desde mes anterior"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.Button,{onClick:()=>{if(E)A(!1),I(0);else{let e=prompt("Ingrese el porcentaje de aumento:");e&&!isNaN(Number(e))&&(I(Number(e)),A(!0))}},variant:"outline",className:`border-purple-500/50 text-purple-400 hover:bg-purple-500/20 ${E?"bg-purple-500/20":""}`,disabled:w,children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-2"}),"✓ Copiar con aumento %"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),"Copiar con aumento %"]})}),E&&(0,a.jsx)("input",{type:"number",value:k,onChange:e=>I(Number(e.target.value)),placeholder:"%",className:"px-2 py-1 bg-gray-800 border border-purple-500/50 rounded text-white w-20 focus:border-purple-400 focus:outline-none"})]})]}),_&&(0,a.jsx)("div",{className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:(0,a.jsx)(s.UploadExcel,{onUpload:L,isProcessing:w})}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:["Obras sociales configuradas: ",(0,a.jsx)("span",{className:"text-green-400 font-semibold",children:N.length})]}),(0,a.jsx)("div",{className:"rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400 bg-green-500/20 border-b border-green-500/30 sticky left-0 z-10",style:{minWidth:"200px"},children:"Obra Social"}),h.map(e=>(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400 bg-green-500/20 border-b border-green-500/30 whitespace-nowrap",style:{minWidth:"150px"},children:e},e))]})}),(0,a.jsx)("tbody",{children:w?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:h.length+1,className:"px-4 py-8 text-center text-gray-400",children:"Cargando..."})}):0===R.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:h.length+1,className:"px-4 py-8 text-center text-gray-400",children:'No hay datos para el mes seleccionado. Use "Importar Excel" o "Copiar desde mes anterior" para comenzar.'})}):R.map((e,r)=>(0,a.jsxs)("tr",{className:"border-b border-white/5 hover:bg-white/5",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 font-medium sticky left-0 bg-gray-900/95",style:{minWidth:"200px"},children:e.obra_social}),h.map(r=>(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)(t.InlineEditCell,{value:e[r],type:"number",onSave:async a=>{await M(e.obra_social,r,Number(a))},isEditable:!0})},r))]},e.obra_social))})]})})})]})})}e.s(["default",()=>g],4601)}]);