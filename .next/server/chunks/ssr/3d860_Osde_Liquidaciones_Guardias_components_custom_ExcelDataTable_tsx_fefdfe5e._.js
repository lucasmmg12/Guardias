module.exports=[99649,56422,a=>{"use strict";var b=a.i(24793),c=a.i(21439),d=a.i(20322);let e=(0,d.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),f=(0,d.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var g=a.i(62353),h=a.i(44874),i=a.i(61110);function j({title:a,count:d,description:j,icon:k,bgColor:l,borderColor:m,textColor:n,rows:o,data:p,onCellUpdate:q,onDeleteRow:r,onDeleteAll:s,allowEdit:t=!1,allowDelete:u=!1,mes:v,anio:w,sectionKey:x,esParticularRow:y,esSinHorarioRow:z,esDuplicadoRow:A,esResidenteFormativoRow:B}){let[C,D]=(0,c.useState)(!1);(0,c.useEffect)(()=>{v&&w&&"true"===localStorage.getItem(`expandable_${x}_${v}_${w}`)&&D(!0)},[v,w,x]);let E=a=>{let b=a.toLowerCase().trim();return b.includes("cliente")||b.includes("obra")};return 0===d?null:(0,b.jsxs)("div",{className:"w-full space-y-2",children:[(0,b.jsx)("div",{className:"p-4 rounded-xl border-2 cursor-pointer transition-all hover:opacity-90",style:{background:l,backdropFilter:"blur(20px)",borderColor:m},onClick:()=>{let a=!C;D(a),v&&w&&localStorage.setItem(`expandable_${x}_${v}_${w}`,String(a))},children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",style:{color:n},children:[k,(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-bold text-lg mb-1",children:a}),(0,b.jsx)("div",{className:"text-sm",style:{color:n,opacity:.8},children:j})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[u&&C&&s&&(0,b.jsxs)(h.Button,{onClick:a=>{a.stopPropagation(),confirm(`\xbfEst\xe1 seguro de que desea eliminar todos los ${d} registros?`)&&s()},size:"sm",variant:"destructive",className:"mr-2",children:[(0,b.jsx)(g.Trash2,{className:"h-4 w-4 mr-1"}),"Eliminar todos"]}),C?(0,b.jsx)(f,{className:"h-6 w-6",style:{color:n}}):(0,b.jsx)(e,{className:"h-6 w-6",style:{color:n}})]})]})}),C&&(0,b.jsx)("div",{className:"rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full border-collapse text-xs",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/10",children:[p.headers.map((a,c)=>(0,b.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap",style:{position:"sticky",top:0,zIndex:10,minWidth:"120px",maxWidth:"200px"},children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{className:"truncate",children:a}),E(a)&&t&&(0,b.jsx)("span",{className:"text-[10px] text-green-400 bg-green-400/20 px-1.5 py-0.5 rounded flex-shrink-0",children:"Editable"})]})},c)),u&&(0,b.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap sticky right-0",style:{position:"sticky",top:0,zIndex:11,minWidth:"60px",maxWidth:"60px"},children:"Acciones"})]})}),(0,b.jsx)("tbody",{children:o.map((a,c)=>{let d=p.rows.findIndex(b=>b===a),e="detalle_completo"===x,f=!!e&&!!y&&y(d),j=!!e&&!!z&&z(d),k=!!e&&!!A&&A(d),l=!!e&&!!B&&B(d),m="transparent";return j?m="rgba(239, 68, 68, 0.15)":k?m="rgba(168, 85, 247, 0.15)":f?m="rgba(251, 191, 36, 0.15)":l&&(m="rgba(59, 130, 246, 0.15)"),(0,b.jsxs)("tr",{className:"border-b transition-colors border-white/5 hover:bg-white/5",style:{backgroundColor:m},children:[p.headers.map((c,e)=>{let f=a[c]??null,g=E(c)&&t;return(0,b.jsx)("td",{className:"px-2 py-1.5 text-xs text-gray-300",style:{minWidth:"120px",maxWidth:"200px"},children:g&&q?(0,b.jsx)(i.InlineEditCell,{value:f||"",onSave:async a=>{await q(d,c,a)},columnName:c}):(0,b.jsx)("span",{className:"truncate block",children:f||"-"})},e)}),u&&r&&(0,b.jsx)("td",{className:"px-2 py-1.5 text-center sticky right-0 bg-gray-900",children:(0,b.jsx)(h.Button,{onClick:async()=>{confirm("Â¿EstÃ¡ seguro de que desea eliminar esta fila?")&&await r(d)},size:"sm",variant:"ghost",className:"text-red-400 hover:text-red-300 hover:bg-red-500/20",children:(0,b.jsx)(g.Trash2,{className:"h-4 w-4"})})})]},d)})})]})})})]})}var k=a.i(9106),l=a.i(55172);let m=(0,d.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);a.s(["Clock",()=>m],56422);let n=(0,d.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),o=(0,d.default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var p=a.i(5415),q=a.i(19147);function r({data:a,especialidad:d,onCellUpdate:e,onDeleteRow:f,liquidacionId:g,mes:h,anio:i}){let[r,s]=(0,c.useState)(a.rows),[t,u]=(0,c.useState)({}),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(!1),z=(0,c.useRef)(a.rows.length);(0,c.useEffect)(()=>{a.rows.length!==z.current&&(z.current=a.rows.length,s(a.rows))},[a.rows.length]),(0,c.useEffect)(()=>{if(!d){w([]),y(!1);return}!async function(){try{if(y(!0),!d)return;let{data:a,error:b}=await q.supabase.from("medicos").select("*").eq("especialidad",d).eq("activo",!0);if(b)throw b;w(a||[])}catch(a){console.error("Error loading mÃ©dicos:",a)}finally{y(!1)}}()},[d]);let A=(0,c.useMemo)(()=>{let a=new Map;return v.forEach(b=>{let c=b.nombre.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();a.set(c,b);let d=b.nombre.split(",").map(a=>a.trim());if(d.length>0){let c=d[0].toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();c&&!a.has(c)&&a.set(c,b)}}),a},[v]),B=(0,c.useCallback)(a=>{if(!a||"string"!=typeof a)return null;let b=a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();if(A.has(b))return A.get(b)||null;for(let[a,c]of A.entries())if(b.includes(a)||a.includes(b))return c;return null},[A]),C=(0,c.useMemo)(()=>{let b=new Set,c=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return"cliente"===b||b.includes("obra social")||"obra social"===b||"obra"===b||b.includes("obra")&&b.includes("social")});if(-1===c)return console.warn("[ExcelDataTable] No se encontrÃ³ columna de Cliente/Obra Social"),b;let d=a.headers[c];return r.forEach((a,c)=>{let e=a[d];(0,p.esParticular)(e)&&b.add(c)}),console.log(`[ExcelDataTable] Filas sin obra social detectadas: ${b.size}`),b},[r,a.headers]),D=(0,c.useMemo)(()=>{let b=new Set;return r.forEach((c,d)=>{(0,p.tieneHorario)(c,a.headers)||b.add(d)}),b},[r,a.headers]),E=(0,c.useMemo)(()=>(0,p.obtenerIndicesDuplicados)(r,a.headers),[r,a.headers]),F=(0,c.useMemo)(()=>{let b=new Set;if(!d||0===v.length||x)return b;let c=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return"responsable"===b||b.includes("responsable")||b.includes("medico")}),e=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return"fecha"===b||b.includes("fecha")||b.includes("fecha visita")}),f=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return b.includes("hora")||b.includes("horario")||b.includes("inicio")});return -1===c||-1===e||-1===f||r.forEach((d,g)=>{let h=d[a.headers[c]],i=d[a.headers[e]],j=d[a.headers[f]],k=B(h);k&&k.es_residente&&(0,p.esResidenteHorarioFormativo)(i,j,k.es_residente)&&b.add(g)}),b},[r,a.headers,d,v,x,B]),G=C.size,H=D.size,I=E.size,J=F.size,K=(0,c.useCallback)(async b=>{if(f){await f(b);let c=r.filter((a,c)=>c!==b);s(c),a.rows=c}else{if(!confirm("Â¿EstÃ¡ seguro de que desea eliminar esta fila?"))return;let c=r.filter((a,c)=>c!==b);s(c),a.rows=c}},[r,a,f]),L=(0,c.useCallback)(async b=>{if(f&&g)for(let a of Array.from(b).sort((a,b)=>b-a))await f(a);else{let c=r.filter((a,c)=>!b.has(c));s(c),a.rows=c}},[r,a,f,g]),M=(0,c.useMemo)(()=>r.filter((a,b)=>C.has(b)),[r,C]),N=(0,c.useMemo)(()=>r.filter((a,b)=>D.has(b)),[r,D]),O=(0,c.useMemo)(()=>r.filter((a,b)=>E.has(b)),[r,E]),P=(0,c.useMemo)(()=>r.filter((a,b)=>F.has(b)),[r,F]);return(0,b.jsxs)("div",{className:"w-full space-y-4",children:[a.periodo&&(0,b.jsx)("div",{className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-green-400",children:[(0,b.jsx)(k.CheckCircle2,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"font-semibold",children:"PerÃ­odo analizado:"}),(0,b.jsxs)("span",{className:"text-white",children:[a.periodo.desde," - ",a.periodo.hasta]})]})}),(0,b.jsx)(j,{title:`âš ï¸ ${G} registro${G>1?"s":""} sin obra social detectado${G>1?"s":""}`,count:G,description:'Estos registros deben ser revisados. Si son pacientes particulares, edite la columna "Cliente" y agregue: "042 - PARTICULARES"',icon:(0,b.jsx)(l.AlertCircle,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(251, 191, 36, 0.15)",borderColor:"rgba(251, 191, 36, 0.5)",textColor:"#fbbf24",rows:M,data:a,onCellUpdate:e,allowEdit:!0,mes:h,anio:i,sectionKey:"sin_obra_social"}),(0,b.jsx)(j,{title:`âš ï¸ ${H} registro${H>1?"s":""} sin horario de inicio detectado${H>1?"s":""}`,count:H,description:"Estos registros indican que el paciente no se atendiÃ³. Deben ser eliminados.",icon:(0,b.jsx)(m,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",textColor:"#ef4444",rows:N,data:a,onDeleteRow:K,onDeleteAll:()=>{L(D)},allowDelete:!0,mes:h,anio:i,sectionKey:"sin_horario"}),(0,b.jsx)(j,{title:`âš ï¸ ${I} registro${I>1?"s":""} duplicado${I>1?"s":""} detectado${I>1?"s":""}`,count:I,description:"Se detectaron filas completamente iguales (misma fecha, misma hora, mismo todo). Revise y elimine los duplicados si es necesario.",icon:(0,b.jsx)(l.AlertCircle,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(168, 85, 247, 0.15)",borderColor:"rgba(168, 85, 247, 0.5)",textColor:"#a855f7",rows:O,data:a,onDeleteRow:K,onDeleteAll:()=>{L(E)},allowDelete:!0,mes:h,anio:i,sectionKey:"duplicados"}),(0,b.jsx)(j,{title:`â„¹ï¸ ${J} consulta${J>1?"s":""} de residente${J>1?"s":""} en horario formativo detectada${J>1?"s":""}`,count:J,description:"Estas consultas son de residentes realizadas entre lunes a sÃ¡bado de 07:00 a 15:00. NO se deben pagar segÃºn las reglas del sistema.",icon:(0,b.jsx)(n,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",textColor:"#3b82f6",rows:P,data:a,onDeleteRow:K,onDeleteAll:()=>{L(F)},allowDelete:!0,mes:h,anio:i,sectionKey:"residente_formativo"}),(0,b.jsx)(j,{title:`ðŸ“Š Ver detalle completo (${r.length} registros)`,count:r.length,description:"Muestra todos los registros del Excel para revisiÃ³n completa con colores segÃºn reglas.",icon:(0,b.jsx)(o,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(34, 197, 94, 0.15)",borderColor:"rgba(34, 197, 94, 0.5)",textColor:"#22c55e",rows:r,data:a,onCellUpdate:e,onDeleteRow:K,allowEdit:!0,allowDelete:!0,mes:h,anio:i,sectionKey:"detalle_completo",esParticularRow:a=>C.has(a),esSinHorarioRow:a=>D.has(a),esDuplicadoRow:a=>E.has(a),esResidenteFormativoRow:a=>F.has(a)}),(0,b.jsxs)("div",{className:"text-sm text-gray-400",children:["Total de filas: ",(0,b.jsx)("span",{className:"text-green-400 font-semibold",children:r.length})," â€¢ ","Columnas: ",(0,b.jsx)("span",{className:"text-green-400 font-semibold",children:a.headers.length}),G>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Sin obra social: ",(0,b.jsx)("span",{className:"text-yellow-400 font-semibold",children:G})]}),H>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Sin horario: ",(0,b.jsx)("span",{className:"text-red-400 font-semibold",children:H})]}),I>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Duplicados: ",(0,b.jsx)("span",{className:"text-purple-400 font-semibold",children:I})]}),J>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Residente formativo: ",(0,b.jsx)("span",{className:"text-blue-400 font-semibold",children:J})]})]})]})}a.s(["ExcelDataTable",()=>r],99649)}];

//# sourceMappingURL=3d860_Osde_Liquidaciones_Guardias_components_custom_ExcelDataTable_tsx_fefdfe5e._.js.map