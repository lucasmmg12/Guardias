module.exports=[99649,56422,80071,21607,a=>{"use strict";var b=a.i(24793),c=a.i(21439),d=a.i(61110),e=a.i(20322);let f=(0,e.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),g=(0,e.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var h=a.i(62353),i=a.i(44874);function j({title:a,count:e,description:j,icon:k,bgColor:l,borderColor:m,textColor:n,rows:o,data:p,onCellUpdate:q,onDeleteRow:r,onDeleteAll:s,allowEdit:t=!1,allowDelete:u=!1,mes:v,anio:w,sectionKey:x}){let[y,z]=(0,c.useState)(!1);(0,c.useEffect)(()=>{v&&w&&"true"===localStorage.getItem(`expandable_${x}_${v}_${w}`)&&z(!0)},[v,w,x]);let A=a=>{let b=a.toLowerCase().trim();return b.includes("cliente")||b.includes("obra")};return 0===e?null:(0,b.jsxs)("div",{className:"w-full space-y-2",children:[(0,b.jsx)("div",{className:"p-4 rounded-xl border-2 cursor-pointer transition-all hover:opacity-90",style:{background:l,backdropFilter:"blur(20px)",borderColor:m},onClick:()=>{let a=!y;z(a),v&&w&&localStorage.setItem(`expandable_${x}_${v}_${w}`,String(a))},children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",style:{color:n},children:[k,(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-bold text-lg mb-1",children:a}),(0,b.jsx)("div",{className:"text-sm",style:{color:n,opacity:.8},children:j})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[u&&y&&s&&(0,b.jsxs)(i.Button,{onClick:a=>{a.stopPropagation(),confirm(`\xbfEst\xe1 seguro de que desea eliminar todos los ${e} registros?`)&&s()},size:"sm",variant:"destructive",className:"mr-2",children:[(0,b.jsx)(h.Trash2,{className:"h-4 w-4 mr-1"}),"Eliminar todos"]}),y?(0,b.jsx)(g,{className:"h-6 w-6",style:{color:n}}):(0,b.jsx)(f,{className:"h-6 w-6",style:{color:n}})]})]})}),y&&(0,b.jsx)("div",{className:"rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full border-collapse text-xs",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/10",children:[p.headers.map((a,c)=>(0,b.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap",style:{position:"sticky",top:0,zIndex:10,minWidth:"120px",maxWidth:"200px"},children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{className:"truncate",children:a}),A(a)&&t&&(0,b.jsx)("span",{className:"text-[10px] text-green-400 bg-green-400/20 px-1.5 py-0.5 rounded flex-shrink-0",children:"Editable"})]})},c)),u&&(0,b.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap sticky right-0",style:{position:"sticky",top:0,zIndex:11,minWidth:"60px",maxWidth:"60px"},children:"Acciones"})]})}),(0,b.jsx)("tbody",{children:o.map((a,c)=>{let e=p.rows.findIndex(b=>b===a);return(0,b.jsxs)("tr",{className:"border-b transition-colors border-white/5 hover:bg-white/5",children:[p.headers.map((c,f)=>{let g=a[c]??null,h=A(c)&&t;return(0,b.jsx)("td",{className:"px-2 py-1.5 text-xs text-gray-300",style:{minWidth:"120px",maxWidth:"200px"},children:h&&q?(0,b.jsx)(d.InlineEditCell,{value:g||"",onSave:async a=>{await q(e,c,a)},columnName:c}):(0,b.jsx)("span",{className:"truncate block",children:g||"-"})},f)}),u&&r&&(0,b.jsx)("td",{className:"px-2 py-1.5 text-center sticky right-0 bg-gray-900",children:(0,b.jsx)(i.Button,{onClick:async()=>{confirm("Â¿EstÃ¡ seguro de que desea eliminar esta fila?")&&await r(e)},size:"sm",variant:"ghost",className:"text-red-400 hover:text-red-300 hover:bg-red-500/20",children:(0,b.jsx)(h.Trash2,{className:"h-4 w-4"})})})]},e)})})]})})})]})}var k=a.i(9106),l=a.i(55172);let m=(0,e.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);a.s(["Clock",()=>m],56422);let n=(0,e.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),o=(0,e.default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var p=a.i(5415),q=a.i(19147);function r({data:a,especialidad:e,onCellUpdate:f,onDeleteRow:g,liquidacionId:i,mes:r,anio:s}){let[t,u]=(0,c.useState)(a.rows),[v,w]=(0,c.useState)({}),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!1),B=(0,c.useRef)(a.rows.length);(0,c.useEffect)(()=>{a.rows.length!==B.current&&(B.current=a.rows.length,u(a.rows))},[a.rows.length]),(0,c.useEffect)(()=>{if(!e){y([]),A(!1);return}!async function(){try{if(A(!0),!e)return;let{data:a,error:b}=await q.supabase.from("medicos").select("*").eq("especialidad",e).eq("activo",!0);if(b)throw b;y(a||[])}catch(a){console.error("Error loading mÃ©dicos:",a)}finally{A(!1)}}()},[e]);let C=(0,c.useMemo)(()=>{let a=new Map;return x.forEach(b=>{let c=b.nombre.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();a.set(c,b);let d=b.nombre.split(",").map(a=>a.trim());if(d.length>0){let c=d[0].toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();c&&!a.has(c)&&a.set(c,b)}}),a},[x]),D=(0,c.useCallback)(a=>{if(!a||"string"!=typeof a)return null;let b=a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();if(C.has(b))return C.get(b)||null;for(let[a,c]of C.entries())if(b.includes(a)||a.includes(b))return c;return null},[C]),E=async(b,c,d)=>{let e=`${b}-${c}`;w(a=>({...a,[e]:!0}));try{let a=[...t];a[b]={...a[b],[c]:d},u(a),f&&await f(b,c,d)}catch(b){throw console.error("Error al guardar celda:",b),u(a.rows),b}finally{w(a=>({...a,[e]:!1}))}},F=a=>{let b=a.toLowerCase().trim();return"cliente"===b||"responsable"===b},G=(0,c.useMemo)(()=>{let b=new Set,c=a.headers.findIndex(a=>"cliente"===a.toLowerCase().trim());return -1===c||t.forEach((d,e)=>{let f=d[a.headers[c]];(0,p.esParticular)(f)&&b.add(e)}),b},[t,a.headers]),H=(0,c.useMemo)(()=>{let b=new Set;return t.forEach((c,d)=>{(0,p.tieneHorario)(c,a.headers)||b.add(d)}),b},[t,a.headers]),I=(0,c.useMemo)(()=>(0,p.obtenerIndicesDuplicados)(t,a.headers),[t,a.headers]),J=(0,c.useMemo)(()=>{let b=new Set;if(!e||0===x.length||z)return b;let c=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return"responsable"===b||b.includes("responsable")||b.includes("medico")}),d=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return"fecha"===b||b.includes("fecha")||b.includes("fecha visita")}),f=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return b.includes("hora")||b.includes("horario")||b.includes("inicio")});return -1===c||-1===d||-1===f||t.forEach((e,g)=>{let h=e[a.headers[c]],i=e[a.headers[d]],j=e[a.headers[f]],k=D(h);k&&k.es_residente&&(0,p.esResidenteHorarioFormativo)(i,j,k.es_residente)&&b.add(g)}),b},[t,a.headers,e,x,z,D]),K=G.size,L=H.size,M=I.size,N=J.size,O=(0,c.useCallback)(async b=>{if(g){await g(b);let c=t.filter((a,c)=>c!==b);u(c),a.rows=c}else{if(!confirm("Â¿EstÃ¡ seguro de que desea eliminar esta fila?"))return;let c=t.filter((a,c)=>c!==b);u(c),a.rows=c}},[t,a,g]),P=(0,c.useCallback)(async b=>{if(g&&i)for(let a of Array.from(b).sort((a,b)=>b-a))await g(a);else{let c=t.filter((a,c)=>!b.has(c));u(c),a.rows=c}},[t,a,g,i]),Q=(0,c.useMemo)(()=>t.filter((a,b)=>G.has(b)),[t,G]),R=(0,c.useMemo)(()=>t.filter((a,b)=>H.has(b)),[t,H]),S=(0,c.useMemo)(()=>t.filter((a,b)=>I.has(b)),[t,I]),T=(0,c.useMemo)(()=>t.filter((a,b)=>J.has(b)),[t,J]);return(0,b.jsxs)("div",{className:"w-full space-y-4",children:[a.periodo&&(0,b.jsx)("div",{className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-green-400",children:[(0,b.jsx)(k.CheckCircle2,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"font-semibold",children:"PerÃ­odo analizado:"}),(0,b.jsxs)("span",{className:"text-white",children:[a.periodo.desde," - ",a.periodo.hasta]})]})}),(0,b.jsx)(j,{title:`âš ï¸ ${K} registro${K>1?"s":""} sin obra social detectado${K>1?"s":""}`,count:K,description:'Estos registros deben ser revisados. Si son pacientes particulares, edite la columna "Cliente" y agregue: "042 - PARTICULARES"',icon:(0,b.jsx)(l.AlertCircle,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(251, 191, 36, 0.15)",borderColor:"rgba(251, 191, 36, 0.5)",textColor:"#fbbf24",rows:Q,data:a,onCellUpdate:f,allowEdit:!0,mes:r,anio:s,sectionKey:"sin_obra_social"}),(0,b.jsx)(j,{title:`âš ï¸ ${L} registro${L>1?"s":""} sin horario de inicio detectado${L>1?"s":""}`,count:L,description:"Estos registros indican que el paciente no se atendiÃ³. Deben ser eliminados.",icon:(0,b.jsx)(m,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",textColor:"#ef4444",rows:R,data:a,onDeleteRow:O,onDeleteAll:()=>{P(H)},allowDelete:!0,mes:r,anio:s,sectionKey:"sin_horario"}),(0,b.jsx)(j,{title:`âš ï¸ ${M} registro${M>1?"s":""} duplicado${M>1?"s":""} detectado${M>1?"s":""}`,count:M,description:"Se detectaron filas completamente iguales (misma fecha, misma hora, mismo todo). Revise y elimine los duplicados si es necesario.",icon:(0,b.jsx)(l.AlertCircle,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(168, 85, 247, 0.15)",borderColor:"rgba(168, 85, 247, 0.5)",textColor:"#a855f7",rows:S,data:a,onDeleteRow:O,onDeleteAll:()=>{P(I)},allowDelete:!0,mes:r,anio:s,sectionKey:"duplicados"}),(0,b.jsx)(j,{title:`â„¹ï¸ ${N} consulta${N>1?"s":""} de residente${N>1?"s":""} en horario formativo detectada${N>1?"s":""}`,count:N,description:"Estas consultas son de residentes realizadas entre lunes a sÃ¡bado de 07:00 a 15:00. NO se deben pagar segÃºn las reglas del sistema.",icon:(0,b.jsx)(n,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",textColor:"#3b82f6",rows:T,data:a,onDeleteRow:O,onDeleteAll:()=>{P(J)},allowDelete:!0,mes:r,anio:s,sectionKey:"residente_formativo"}),(0,b.jsx)(j,{title:`ðŸ“Š Ver detalle completo (${t.length} registros)`,count:t.length,description:"Muestra todos los registros del Excel para revisiÃ³n completa.",icon:(0,b.jsx)(o,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(34, 197, 94, 0.15)",borderColor:"rgba(34, 197, 94, 0.5)",textColor:"#22c55e",rows:t,data:a,onCellUpdate:f,onDeleteRow:O,allowEdit:!0,allowDelete:!0,mes:r,anio:s,sectionKey:"detalle_completo"}),(0,b.jsx)("div",{className:"overflow-x-auto rounded-xl",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,b.jsxs)("table",{className:"w-full border-collapse text-xs",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/10",children:[a.headers.map((a,c)=>(0,b.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap",style:{position:"sticky",top:0,zIndex:10,minWidth:"120px",maxWidth:"200px"},children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{className:"truncate",children:a}),F(a)&&(0,b.jsx)("span",{className:"text-[10px] text-green-400 bg-green-400/20 px-1.5 py-0.5 rounded flex-shrink-0",children:"Editable"})]})},c)),(0,b.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap sticky right-0",style:{position:"sticky",top:0,zIndex:11,minWidth:"60px",maxWidth:"60px"},children:"Acciones"})]})}),(0,b.jsx)("tbody",{children:0===t.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:a.headers.length+1,className:"px-4 py-8 text-center text-gray-400 text-sm",children:"No hay datos para mostrar"})}):t.map((c,e)=>{let f=G.has(e),g=H.has(e),i=I.has(e),j=J.has(e),k="border-b transition-colors border-white/5 hover:bg-white/5";return g?k="bg-red-500/20 border-red-500/30 hover:bg-red-500/30 border-b":i?k="bg-purple-500/20 border-purple-500/30 hover:bg-purple-500/30 border-b":j?k="bg-blue-500/20 border-blue-500/30 hover:bg-blue-500/30 border-b":f&&(k="bg-yellow-500/20 border-yellow-500/30 hover:bg-yellow-500/30 border-b"),(0,b.jsxs)("tr",{className:k,children:[a.headers.map((a,g)=>{let h=c[a]??null,i=F(a),j=v[`${e}-${a}`]||!1;return(0,b.jsx)("td",{className:"px-2 py-1.5 text-xs text-gray-300",style:{minWidth:"120px",maxWidth:"200px"},children:i?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(d.InlineEditCell,{value:h,type:"text",onSave:async b=>{await E(e,a,b)},isEditable:!0,className:j?"opacity-50":"",columnName:a}),f&&"cliente"===a.toLowerCase().trim()&&(0,b.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,b.jsx)(l.AlertCircle,{className:"h-3 w-3 text-yellow-400"})})]}):(0,b.jsx)("div",{className:"px-1 py-0.5 truncate",title:h?String(h):"",children:null===h||""===h?(0,b.jsx)("span",{className:"text-gray-500 italic text-[10px]",children:"-"}):(0,b.jsx)("span",{className:"truncate block",children:String(h)})})},g)}),(0,b.jsx)("td",{className:`px-2 py-1.5 sticky right-0 ${g?"bg-red-500/20":i?"bg-purple-500/20":j?"bg-blue-500/20":f?"bg-yellow-500/20":"bg-white/5"}`,style:{minWidth:"60px",maxWidth:"60px",zIndex:1},children:(0,b.jsxs)("div",{className:"flex items-center justify-center gap-1 relative",children:[(g||i)&&(0,b.jsx)("button",{onClick:()=>O(e),className:"p-1.5 text-red-400 hover:bg-red-500/30 rounded transition-colors",title:"Eliminar fila",children:(0,b.jsx)(h.Trash2,{className:"h-4 w-4"})}),g&&(0,b.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,b.jsx)(m,{className:"h-3 w-3 text-red-400"})}),i&&!g&&(0,b.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,b.jsx)(l.AlertCircle,{className:"h-3 w-3 text-purple-400"})}),j&&!g&&!i&&(0,b.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,b.jsx)(n,{className:"h-3 w-3 text-blue-400"})})]})})]},e)})})]})}),(0,b.jsxs)("div",{className:"text-sm text-gray-400",children:["Total de filas: ",(0,b.jsx)("span",{className:"text-green-400 font-semibold",children:t.length})," â€¢ ","Columnas: ",(0,b.jsx)("span",{className:"text-green-400 font-semibold",children:a.headers.length}),K>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Sin obra social: ",(0,b.jsx)("span",{className:"text-yellow-400 font-semibold",children:K})]}),L>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Sin horario: ",(0,b.jsx)("span",{className:"text-red-400 font-semibold",children:L})]}),M>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Duplicados: ",(0,b.jsx)("span",{className:"text-purple-400 font-semibold",children:M})]}),N>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Residente formativo: ",(0,b.jsx)("span",{className:"text-blue-400 font-semibold",children:N})]})]})]})}a.s(["ExcelDataTable",()=>r],99649);let s=(0,e.default)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var t=a.i(31976);function u({mes:a,anio:d,especialidad:e}){let[f,g]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(0);async function l(){try{i(!0);let{error:b}=await q.supabase.rpc("sincronizar_estadisticas_obra_social",{p_mes:a,p_anio:d,p_especialidad:e});b&&console.error("Error sincronizando estadÃ­sticas:",b);let{data:c,error:f}=await q.supabase.from("v_estadisticas_obra_social_consolidado").select("obra_social, cantidad_consultas, porcentaje_del_total, total_consultas_mes").eq("mes",a).eq("anio",d).eq("especialidad",e).order("cantidad_consultas",{ascending:!1});if(f)throw f;c&&c.length>0?(g(c),k(c[0]?.total_consultas_mes||0)):(g([]),k(0))}catch(a){console.error("Error cargando estadÃ­sticas:",a)}finally{i(!1)}}if((0,c.useEffect)(()=>{l()},[a,d,e]),h)return(0,b.jsx)("div",{className:"p-6 text-center text-gray-400",children:"Cargando estadÃ­sticas..."});if(0===f.length)return(0,b.jsx)("div",{className:"p-6 rounded-xl",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,b.jsxs)("div",{className:"text-center text-gray-400",children:[(0,b.jsx)(s,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,b.jsx)("p",{children:"No hay estadÃ­sticas disponibles para este perÃ­odo"})]})});let m=Math.max(...f.map(a=>a.cantidad_consultas));return(0,b.jsxs)("div",{className:"p-6 rounded-xl space-y-4",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-green-500/20 rounded-lg",children:(0,b.jsx)(s,{className:"h-5 w-5 text-green-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"EstadÃ­sticas por Obra Social"}),(0,b.jsxs)("p",{className:"text-sm text-gray-400",children:[a,"/",d," - ",e]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-400",children:j}),(0,b.jsx)("div",{className:"text-xs text-gray-400",children:"Total consultas"})]})]}),(0,b.jsx)("div",{className:"space-y-2",children:f.map((a,c)=>{let d=a.porcentaje_del_total||0,e=a.cantidad_consultas/m*100,f=a.obra_social.includes("042")||a.obra_social.includes("PARTICULARES");return(0,b.jsxs)("div",{className:"p-3 rounded-lg",style:{background:f?"rgba(251, 191, 36, 0.1)":"rgba(255, 255, 255, 0.03)",border:f?"1px solid rgba(251, 191, 36, 0.3)":"1px solid rgba(255, 255, 255, 0.05)"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,b.jsx)(t.Users,{className:`h-4 w-4 flex-shrink-0 ${f?"text-yellow-400":"text-gray-400"}`}),(0,b.jsx)("span",{className:`font-medium truncate ${f?"text-yellow-300":"text-gray-300"}`,children:a.obra_social})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-green-400",children:a.cantidad_consultas}),(0,b.jsxs)("span",{className:"text-xs text-gray-400 w-12 text-right",children:[d.toFixed(1),"%"]})]})]}),(0,b.jsx)("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full transition-all duration-500",style:{width:`${e}%`,background:f?"linear-gradient(90deg, rgba(251, 191, 36, 0.8), rgba(251, 191, 36, 0.6))":"linear-gradient(90deg, rgba(34, 197, 94, 0.8), rgba(34, 197, 94, 0.6))"}})})]},c)})}),(0,b.jsx)("div",{className:"pt-4 border-t border-white/10",children:(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-green-400",children:f.length}),(0,b.jsx)("div",{className:"text-xs text-gray-400",children:"Obras Sociales"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-blue-400",children:f.filter(a=>a.obra_social.includes("042")||a.obra_social.includes("PARTICULARES")).length}),(0,b.jsx)("div",{className:"text-xs text-gray-400",children:"Particulares"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-yellow-400",children:f[0]?.cantidad_consultas||0}),(0,b.jsx)("div",{className:"text-xs text-gray-400",children:"Mayor cantidad"})]})]})})]})}a.s(["EstadisticasObraSocial",()=>u],80071);var v=a.i(29839);async function w(a){try{let b=await a.arrayBuffer(),c=v.read(b,{type:"array"}),d=c.SheetNames[0];if(!d)throw Error("El archivo Excel no contiene hojas");let e=c.Sheets[d],f=v.utils.decode_range(e["!ref"]||"A1"),g=[];for(let a=0;a<=Math.min(f.e.c,50);a++){let b=e[v.utils.encode_cell({r:1,c:a})];g.push(b?b.v:null)}let h=function(a){if(!a||0===a.length)return null;let b=a.map(a=>String(a||"")).join(" "),c=b.match(/Desde fecha:\s*(\d{1,2}\/\d{1,2}\/\d{4})/i),d=b.match(/Hasta fecha:\s*(\d{1,2}\/\d{1,2}\/\d{4})/i);return c&&d?{desde:c[1],hasta:d[1]}:null}(g),i=[],j=Math.min(f.e.c+1,50),k=-1;for(let a=0;a<j;a++){let b=e[v.utils.encode_cell({r:9,c:a})];if(b&&null!==b.v&&void 0!==b.v){let c=String(b.v).trim();""!==c&&(k=a)}}if(-1===k)throw Error("No se encontraron headers en la fila 10");for(let a=0;a<=k;a++){let b=e[v.utils.encode_cell({r:9,c:a})];if(b&&null!==b.v&&void 0!==b.v){let c=String(b.v).trim();i.push({name:c||`Columna ${a+1}`,colIndex:a})}else i.push({name:`Columna ${a+1}`,colIndex:a})}let l=i.map(a=>a.name).filter(a=>!a.startsWith("Columna")),m=[];for(let a=10;a<=f.e.r;a++){let b={},c=!1;i.forEach(d=>{let f=e[v.utils.encode_cell({r:a,c:d.colIndex})];if(f&&null!==f.v&&void 0!==f.v){let a=f.v;if(d.name.toLowerCase().includes("duraciÃ³n")||d.name.toLowerCase().includes("duracion")){if("number"==typeof a)a=Math.round(a);else if("string"==typeof a){let b=parseFloat(a.replace(",","."));a=isNaN(b)?a:Math.round(b)}}else if("d"===f.t&&a instanceof Date){let b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();a=`${b}/${c}/${d}`}else if("n"===f.t&&"number"==typeof a&&a>1&&a<1e5)try{let b=v.SSF.parse_date_code(a);b&&(a=`${b.d}/${b.m}/${b.y}`)}catch{}d.name.startsWith("Columna")||(b[d.name]=a,c=!0)}else d.name.startsWith("Columna")||(b[d.name]=null)}),c&&m.push(b)}return{periodo:h,headers:l,rows:m}}catch(a){if(a instanceof Error)throw a;throw Error("Error al leer el archivo Excel: "+String(a))}}a.s(["readExcelFile",()=>w],21607)}];

//# sourceMappingURL=3d860_Osde_Liquidaciones_Guardias_components_custom_ExcelDataTable_tsx_fefdfe5e._.js.map