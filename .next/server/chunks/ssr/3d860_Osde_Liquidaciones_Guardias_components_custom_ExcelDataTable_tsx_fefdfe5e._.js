module.exports=[99649,a=>{"use strict";var b=a.i(24793),c=a.i(21439),d=a.i(20322);let e=(0,d.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),f=(0,d.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var g=a.i(62353),h=a.i(44874),i=a.i(61110),j=a.i(8570),k=a.i(15269),l=a.i(66873);function m({isOpen:a,onClose:d,onConfirm:e,title:f,message:g,confirmText:i="Aceptar",cancelText:m="Cancelar",type:n="danger"}){let[o,p]=(0,c.useState)(!1);if((0,c.useEffect)(()=>(p(!0),()=>p(!1)),[]),!a||!o)return null;let q=()=>{switch(n){case"danger":return"text-red-400";case"warning":return"text-yellow-400";default:return"text-blue-400"}},r=(0,b.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",style:{background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(8px)",zIndex:9999,position:"fixed",top:0,left:0,right:0,bottom:0},onClick:d,children:(0,b.jsxs)("div",{className:"relative w-full max-w-md rounded-2xl p-6 shadow-2xl",style:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:`1px solid ${(()=>{switch(n){case"danger":return"border-red-500/50";case"warning":return"border-yellow-500/50";default:return"border-blue-500/50"}})().replace("/50","/30")}`,boxShadow:"0 8px 32px 0 rgba(34, 197, 94, 0.3)",animation:"fadeIn 0.2s ease-in-out"},onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("button",{onClick:d,className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-white/10 transition-colors text-gray-400 hover:text-white",children:(0,b.jsx)(k.X,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mt-1",children:(0,b.jsx)(l.AlertTriangle,{className:`h-6 w-6 ${q()}`})}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)("h3",{className:`text-lg font-semibold ${q()}`,children:f}),(0,b.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed",children:g})]})]}),(0,b.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,b.jsx)(h.Button,{onClick:d,variant:"outline",className:"border-gray-500/50 text-gray-300 hover:bg-gray-500/20",children:m}),(0,b.jsx)(h.Button,{onClick:()=>{e(),d()},className:(()=>{switch(n){case"danger":return"bg-red-600 hover:bg-red-500 text-white";case"warning":return"bg-yellow-600 hover:bg-yellow-500 text-white";default:return"bg-blue-600 hover:bg-blue-500 text-white"}})(),children:i})]})]})});return(0,j.createPortal)(r,document.body)}function n({title:a,count:d,description:j,icon:k,bgColor:l,borderColor:n,textColor:o,rows:p,data:q,onCellUpdate:r,onDeleteRow:s,onDeleteAll:t,allowEdit:u=!1,allowDelete:v=!1,mes:w,anio:x,sectionKey:y,esParticularRow:z,esSinHorarioRow:A,esDuplicadoRow:B,esResidenteFormativoRow:C}){let[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(new Set),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null);(0,c.useEffect)(()=>{w&&x&&"true"===localStorage.getItem(`expandable_${y}_${w}_${x}`)&&E(!0)},[w,x,y]);let L=a=>{let b=a.toLowerCase().trim();return b.includes("cliente")||b.includes("obra")};return 0===d?null:(0,b.jsxs)("div",{className:"w-full space-y-2",children:[(0,b.jsx)("div",{className:"p-4 rounded-xl border-2 cursor-pointer transition-all hover:opacity-90",style:{background:l,backdropFilter:"blur(20px)",borderColor:n},onClick:()=>{let a=!D;E(a),w&&x&&localStorage.setItem(`expandable_${y}_${w}_${x}`,String(a)),a||G(new Set)},children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",style:{color:o},children:[k,(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-bold text-lg mb-1",children:a}),(0,b.jsx)("div",{className:"text-sm",style:{color:o,opacity:.8},children:j})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[v&&D&&(0,b.jsxs)(b.Fragment,{children:[F.size>0&&(0,b.jsxs)(h.Button,{onClick:a=>{a.stopPropagation(),K({type:"multiple",count:F.size}),I(!0)},size:"sm",variant:"destructive",className:"mr-2",children:[(0,b.jsx)(g.Trash2,{className:"h-4 w-4 mr-1"}),"Eliminar seleccionados (",F.size,")"]}),t&&(0,b.jsxs)(h.Button,{onClick:a=>{a.stopPropagation(),K({type:"all",count:d}),I(!0)},size:"sm",variant:"destructive",className:"mr-2",children:[(0,b.jsx)(g.Trash2,{className:"h-4 w-4 mr-1"}),"Eliminar todos"]})]}),D?(0,b.jsx)(f,{className:"h-6 w-6",style:{color:o}}):(0,b.jsx)(e,{className:"h-6 w-6",style:{color:o}})]})]})}),D&&(0,b.jsx)("div",{className:"rounded-xl overflow-hidden",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full border-collapse text-xs",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-white/10",children:[v&&(0,b.jsx)("th",{className:"px-2 py-2 text-center text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap sticky left-0",style:{position:"sticky",top:0,zIndex:12,minWidth:"50px",maxWidth:"50px",background:"rgba(0, 0, 0, 0.8)"},children:(0,b.jsx)("input",{type:"checkbox",checked:F.size===p.length&&p.length>0,onChange:a=>{a.target.checked?G(new Set(p.map((a,b)=>q.rows.findIndex(a=>a===p[b])).filter(a=>-1!==a))):G(new Set)},className:"w-4 h-4 rounded border-gray-500 bg-gray-800 text-green-500 focus:ring-green-500 focus:ring-2",onClick:a=>a.stopPropagation()})}),q.headers.map((a,c)=>(0,b.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap",style:{position:"sticky",top:0,zIndex:10,minWidth:"120px",maxWidth:"200px"},children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{className:"truncate",children:a}),L(a)&&u&&(0,b.jsx)("span",{className:"text-[10px] text-green-400 bg-green-400/20 px-1.5 py-0.5 rounded flex-shrink-0",children:"Editable"})]})},c)),v&&(0,b.jsx)("th",{className:"px-2 py-2 text-left text-xs font-semibold text-gray-300 bg-white/5 whitespace-nowrap sticky right-0",style:{position:"sticky",top:0,zIndex:11,minWidth:"60px",maxWidth:"60px"},children:"Acciones"})]})}),(0,b.jsx)("tbody",{children:p.map((a,c)=>{let d=q.rows.findIndex(b=>b===a),e=F.has(d),f="detalle_completo"===y,j=!!f&&!!z&&z(d),k=!!f&&!!A&&A(d),l=!!f&&!!B&&B(d),m=!!f&&!!C&&C(d),n="transparent";return k?n="rgba(239, 68, 68, 0.15)":l?n="rgba(168, 85, 247, 0.15)":j?n="rgba(251, 191, 36, 0.15)":m&&(n="rgba(59, 130, 246, 0.15)"),e&&(n="transparent"===n?"rgba(34, 197, 94, 0.2)":n.replace("0.15","0.25")),(0,b.jsxs)("tr",{className:"border-b transition-colors border-white/5 hover:bg-white/5",style:{backgroundColor:n,borderLeft:e?"3px solid rgba(34, 197, 94, 0.8)":void 0},children:[v&&(0,b.jsx)("td",{className:"px-2 py-1.5 text-center sticky left-0 z-10",style:{minWidth:"50px",maxWidth:"50px",background:"transparent"!==n?n:"rgba(0, 0, 0, 0.5)"},onClick:a=>a.stopPropagation(),children:(0,b.jsx)("input",{type:"checkbox",checked:e,onChange:a=>{let b=new Set(F);a.target.checked?b.add(d):b.delete(d),G(b)},className:"w-4 h-4 rounded border-gray-500 bg-gray-800 text-green-500 focus:ring-green-500 focus:ring-2"})}),q.headers.map((c,e)=>{let f=a[c]??null,g=L(c)&&u;return(0,b.jsx)("td",{className:"px-2 py-1.5 text-xs text-gray-300",style:{minWidth:"120px",maxWidth:"200px"},children:g&&r?(0,b.jsx)(i.InlineEditCell,{value:f||"",onSave:async a=>{await r(d,c,a)},columnName:c}):(0,b.jsx)("span",{className:"truncate block",children:f||"-"})},e)}),v&&s&&(0,b.jsx)("td",{className:"px-2 py-1.5 text-center sticky right-0",style:{background:"transparent"!==n?n:"rgba(0, 0, 0, 0.5)"},children:(0,b.jsx)(h.Button,{onClick:async a=>{a.stopPropagation(),K({type:"single",rowIndex:d}),I(!0)},size:"sm",variant:"ghost",className:"text-red-400 hover:text-red-300 hover:bg-red-500/20",children:(0,b.jsx)(g.Trash2,{className:"h-4 w-4"})})})]},d)})})]})})}),(0,b.jsx)(m,{isOpen:H,onClose:()=>{I(!1),K(null)},onConfirm:async()=>{if(J)try{if("all"===J.type&&t)await t(),G(new Set);else if("multiple"===J.type&&s){for(let a of Array.from(F).sort((a,b)=>b-a))await s(a);G(new Set)}else if("single"===J.type&&void 0!==J.rowIndex&&s){await s(J.rowIndex);let a=new Set(F);a.delete(J.rowIndex),G(a)}}catch(a){console.error("Error eliminando filas:",a)}},title:"Confirmar eliminaciÃ³n",message:J?.type==="all"?`\xbfEst\xe1 seguro de que desea eliminar todos los ${J.count} registros? Esta acci\xf3n no se puede deshacer.`:J?.type==="multiple"?`\xbfEst\xe1 seguro de que desea eliminar los ${J.count} registros seleccionados? Esta acci\xf3n no se puede deshacer.`:"Â¿EstÃ¡ seguro de que desea eliminar esta fila? Esta acciÃ³n no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar",type:"danger"})]})}var o=a.i(9106),p=a.i(55172);let q=(0,d.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),r=(0,d.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),s=(0,d.default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var t=a.i(5415),u=a.i(19147);function v({data:a,especialidad:d,onCellUpdate:e,onDeleteRow:f,liquidacionId:g,mes:h,anio:i}){let[j,k]=(0,c.useState)(a.rows),[l,m]=(0,c.useState)({}),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(!1),z=(0,c.useRef)(a.rows.length);(0,c.useEffect)(()=>{a.rows.length!==z.current&&(z.current=a.rows.length,k(a.rows))},[a.rows.length]),(0,c.useEffect)(()=>{if(!d){w([]),y(!1);return}!async function(){try{if(y(!0),!d)return;let{data:a,error:b}=await u.supabase.from("medicos").select("*").eq("especialidad",d).eq("activo",!0);if(b)throw b;w(a||[])}catch(a){console.error("Error loading mÃ©dicos:",a)}finally{y(!1)}}()},[d]);let A=(0,c.useMemo)(()=>{let a=new Map;return v.forEach(b=>{let c=b.nombre.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();a.set(c,b);let d=b.nombre.split(",").map(a=>a.trim());if(d.length>0){let c=d[0].toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();c&&!a.has(c)&&a.set(c,b)}}),a},[v]),B=(0,c.useCallback)(a=>{if(!a||"string"!=typeof a)return null;let b=a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();if(A.has(b))return A.get(b)||null;for(let[a,c]of A.entries())if(b.includes(a)||a.includes(b))return c;return null},[A]),C=(0,c.useMemo)(()=>{let b=new Set,c=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return"cliente"===b||b.includes("obra social")||"obra social"===b||"obra"===b||b.includes("obra")&&b.includes("social")});if(-1===c)return console.warn("[ExcelDataTable] No se encontrÃ³ columna de Cliente/Obra Social"),b;let d=a.headers[c];return j.forEach((a,c)=>{let e=a[d];(0,t.esParticular)(e)&&b.add(c)}),console.log(`[ExcelDataTable] Filas sin obra social detectadas: ${b.size}`),b},[j,a.headers]),D=(0,c.useMemo)(()=>{let b=new Set;return j.forEach((c,d)=>{(0,t.tieneHorario)(c,a.headers)||b.add(d)}),b},[j,a.headers]),E=(0,c.useMemo)(()=>(0,t.obtenerIndicesDuplicados)(j,a.headers),[j,a.headers]),F=(0,c.useMemo)(()=>{let b=new Set;if(!d||0===v.length||x)return b;let c=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return"responsable"===b||b.includes("responsable")||b.includes("medico")}),e=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return"fecha"===b||b.includes("fecha")||b.includes("fecha visita")}),f=a.headers.findIndex(a=>{let b=a.toLowerCase().trim();return b.includes("hora")||b.includes("horario")||b.includes("inicio")});return -1===c||-1===e||-1===f||j.forEach((d,g)=>{let h=d[a.headers[c]],i=d[a.headers[e]],j=d[a.headers[f]],k=B(h);k&&k.es_residente&&(0,t.esResidenteHorarioFormativo)(i,j,k.es_residente)&&b.add(g)}),b},[j,a.headers,d,v,x,B]),G=C.size,H=D.size,I=E.size,J=F.size,K=(0,c.useCallback)(async b=>{if(f){await f(b);let c=j.filter((a,c)=>c!==b);k(c),a.rows=c}else{let c=j.filter((a,c)=>c!==b);k(c),a.rows=c}},[j,a,f]),L=(0,c.useCallback)(async b=>{if(f)for(let a of Array.from(b).sort((a,b)=>b-a))await f(a);else{let c=j.filter((a,c)=>!b.has(c));k(c),a.rows=c}},[j,a,f]),M=(0,c.useMemo)(()=>j.filter((a,b)=>C.has(b)),[j,C]),N=(0,c.useMemo)(()=>j.filter((a,b)=>D.has(b)),[j,D]),O=(0,c.useMemo)(()=>j.filter((a,b)=>E.has(b)),[j,E]),P=(0,c.useMemo)(()=>j.filter((a,b)=>F.has(b)),[j,F]),Q=(0,c.useCallback)(async()=>{await L(D)},[D,L]),R=(0,c.useCallback)(async()=>{await L(E)},[E,L]),S=(0,c.useCallback)(async()=>{await L(F)},[F,L]);return(0,b.jsxs)("div",{className:"w-full space-y-4",children:[a.periodo&&(0,b.jsx)("div",{className:"p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-green-400",children:[(0,b.jsx)(o.CheckCircle2,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"font-semibold",children:"PerÃ­odo analizado:"}),(0,b.jsxs)("span",{className:"text-white",children:[a.periodo.desde," - ",a.periodo.hasta]})]})}),(0,b.jsx)(n,{title:`âš ï¸ ${G} registro${G>1?"s":""} sin obra social detectado${G>1?"s":""}`,count:G,description:'Estos registros deben ser revisados. Si son pacientes particulares, edite la columna "Cliente" y agregue: "042 - PARTICULARES"',icon:(0,b.jsx)(p.AlertCircle,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(251, 191, 36, 0.15)",borderColor:"rgba(251, 191, 36, 0.5)",textColor:"#fbbf24",rows:M,data:a,onCellUpdate:e,allowEdit:!0,mes:h,anio:i,sectionKey:"sin_obra_social"}),(0,b.jsx)(n,{title:`âš ï¸ ${H} registro${H>1?"s":""} sin horario de inicio detectado${H>1?"s":""}`,count:H,description:"Estos registros indican que el paciente no se atendiÃ³. Deben ser eliminados.",icon:(0,b.jsx)(q,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",textColor:"#ef4444",rows:N,data:a,onDeleteRow:K,onDeleteAll:Q,allowDelete:!0,mes:h,anio:i,sectionKey:"sin_horario"}),(0,b.jsx)(n,{title:`âš ï¸ ${I} registro${I>1?"s":""} duplicado${I>1?"s":""} detectado${I>1?"s":""}`,count:I,description:"Se detectaron filas completamente iguales (misma fecha, misma hora, mismo todo). Revise y elimine los duplicados si es necesario.",icon:(0,b.jsx)(p.AlertCircle,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(168, 85, 247, 0.15)",borderColor:"rgba(168, 85, 247, 0.5)",textColor:"#a855f7",rows:O,data:a,onDeleteRow:K,onDeleteAll:R,allowDelete:!0,mes:h,anio:i,sectionKey:"duplicados"}),(0,b.jsx)(n,{title:`â„¹ï¸ ${J} consulta${J>1?"s":""} de residente${J>1?"s":""} en horario formativo detectada${J>1?"s":""}`,count:J,description:"Estas consultas son de residentes realizadas entre lunes a sÃ¡bado de 07:00 a 15:00. NO se deben pagar segÃºn las reglas del sistema.",icon:(0,b.jsx)(r,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",textColor:"#3b82f6",rows:P,data:a,onDeleteRow:K,onDeleteAll:S,allowDelete:!0,mes:h,anio:i,sectionKey:"residente_formativo"}),(0,b.jsx)(n,{title:`ðŸ“Š Ver detalle completo (${j.length} registros)`,count:j.length,description:"Muestra todos los registros del Excel para revisiÃ³n completa con colores segÃºn reglas.",icon:(0,b.jsx)(s,{className:"h-6 w-6 flex-shrink-0"}),bgColor:"rgba(34, 197, 94, 0.15)",borderColor:"rgba(34, 197, 94, 0.5)",textColor:"#22c55e",rows:j,data:a,onCellUpdate:e,onDeleteRow:K,allowEdit:!0,allowDelete:!0,mes:h,anio:i,sectionKey:"detalle_completo",esParticularRow:a=>C.has(a),esSinHorarioRow:a=>D.has(a),esDuplicadoRow:a=>E.has(a),esResidenteFormativoRow:a=>F.has(a)}),(0,b.jsxs)("div",{className:"text-sm text-gray-400",children:["Total de filas: ",(0,b.jsx)("span",{className:"text-green-400 font-semibold",children:j.length})," â€¢ ","Columnas: ",(0,b.jsx)("span",{className:"text-green-400 font-semibold",children:a.headers.length}),G>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Sin obra social: ",(0,b.jsx)("span",{className:"text-yellow-400 font-semibold",children:G})]}),H>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Sin horario: ",(0,b.jsx)("span",{className:"text-red-400 font-semibold",children:H})]}),I>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Duplicados: ",(0,b.jsx)("span",{className:"text-purple-400 font-semibold",children:I})]}),J>0&&(0,b.jsxs)(b.Fragment,{children:[" â€¢ ","Residente formativo: ",(0,b.jsx)("span",{className:"text-blue-400 font-semibold",children:J})]})]})]})}a.s(["ExcelDataTable",()=>v],99649)}];

//# sourceMappingURL=3d860_Osde_Liquidaciones_Guardias_components_custom_ExcelDataTable_tsx_fefdfe5e._.js.map