module.exports=[55649,a=>{"use strict";var b=a.i(24793),c=a.i(21439),d=a.i(48168),e=a.i(19147),f=a.i(5415);async function g(a,b){let{data:c}=await e.supabase.from("liquidaciones_guardia").select("id").eq("especialidad","Ginecolog칤a").eq("mes",a).eq("anio",b).single();if(!c||!c.id)return[];let d=c.id,{data:g}=await e.supabase.from("detalle_guardia").select("*").eq("liquidacion_id",d);if(!g||0===g.length)return[];let{data:h}=await e.supabase.from("valores_consultas_obra_social").select("*").eq("tipo_consulta","CONSULTA GINECOLOGICA").eq("mes",a).eq("anio",b);if(!h||0===h.length)return[];let i=new Map;h.forEach(a=>{i.set(a.obra_social,a.valor)});let j=new Map;return g.forEach(a=>{let b=!0===a.medico_es_residente;if((0,f.esResidenteHorarioFormativo)(a.fecha,a.hora,b))return;let c=a.obra_social||"PARTICULARES",d=a.medico_nombre||"Desconocido",e=a.medico_id||"sin-id",g=`${e}|${c}`,h=i.get(c)||0;if(j.has(g)){let a=j.get(g);a.cantidad+=1,a.total=a.cantidad*a.valor_unitario}else j.set(g,{medico_id:a.medico_id,medico_nombre:d,obra_social:c,cantidad:1,valor_unitario:h,total:h})}),Array.from(j.values()).sort((a,b)=>a.medico_nombre!==b.medico_nombre?a.medico_nombre.localeCompare(b.medico_nombre):a.obra_social.localeCompare(b.obra_social))}async function h(a,b){let c=await g(a,b),d=new Map;return c.forEach(a=>{let b=a.medico_id||"sin-id",c=a.medico_nombre;if(d.has(b)){let c=d.get(b);c.cantidad+=a.cantidad,c.total_bruto+=a.total,c.retencion_20=.2*c.total_bruto,c.total_neto=c.total_bruto-c.retencion_20}else{let e=a.total,f=.2*e;d.set(b,{medico_id:a.medico_id,medico_nombre:c,cantidad:a.cantidad,total_bruto:e,retencion_20:f,total_neto:e-f})}}),Array.from(d.values()).sort((a,b)=>a.medico_nombre.localeCompare(b.medico_nombre))}var i=a.i(22254),j=a.i(65266);let k=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],l=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];var m=a.i(44874),n=a.i(53315),o=a.i(74961),p=a.i(84230),q=a.i(20322);let r=(0,q.default)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),s=(0,q.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var t=a.i(63009),u=a.i(99649);async function v(a,b,c){try{let{data:d,error:e}=await b.from("detalle_guardia").select("id, fecha, hora, paciente, obra_social, medico_nombre, fila_excel").eq("liquidacion_id",a).order("fila_excel",{ascending:!0,nullsFirst:!1});if(e)return console.error("Error cargando detalles:",e),null;if(!d||0===d.length)return null;return function(a,b){if(0===a.length)return{periodo:null,headers:b||[],rows:[]};let c=[...a].sort((a,b)=>(a.fila_excel||0)-(b.fila_excel||0)),d=b||["Fecha","Hora","Paciente","Obra Social","Responsable"],e=c.map(a=>{let b={};return null!==a.fila_excel&&void 0!==a.fila_excel&&(b.__fila_excel=a.fila_excel),d.forEach(c=>{let d=c.toLowerCase().trim();if(d.includes("fecha")||d.includes("date"))if(a.fecha){let d=new Date(a.fecha);if(isNaN(d.getTime()))b[c]=a.fecha;else{let a=String(d.getDate()).padStart(2,"0"),e=String(d.getMonth()+1).padStart(2,"0"),f=d.getFullYear();b[c]=`${a}/${e}/${f}`}}else b[c]=null;else d.includes("hora")||d.includes("horario")?b[c]=a.hora||null:d.includes("paciente")?b[c]=a.paciente||null:d.includes("obra")||d.includes("cliente")?b[c]=a.obra_social||null:d.includes("responsable")||d.includes("medico")?b[c]=a.medico_nombre||null:b[c]=null}),b}),f=null;if(c.length>0){let a=c.map(a=>a.fecha?new Date(a.fecha):null).filter(a=>null!==a&&!isNaN(a.getTime())).sort((a,b)=>a.getTime()-b.getTime());if(a.length>0){let b=a[0],c=a[a.length-1],d=a=>{let b=String(a.getDate()).padStart(2,"0"),c=String(a.getMonth()+1).padStart(2,"0"),d=a.getFullYear();return`${b}/${c}/${d}`};f={desde:d(b),hasta:d(c)}}}return{periodo:f,headers:d,rows:e}}(d,c)}catch(a){return console.error("Error en cargarExcelDataDesdeBD:",a),null}}let w=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}];function x(){let a=(0,d.useRouter)(),[q,x]=(0,c.useState)(()=>new Date().getMonth()+1),[z,A]=(0,c.useState)(()=>new Date().getFullYear()),[B,C]=(0,c.useState)(new Map),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)("medicos"),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)(null),[T,U]=(0,c.useState)(!1);async function V(){U(!0);try{let{data:a,error:b}=await e.supabase.from("liquidaciones_guardia").select("*").eq("especialidad","Ginecolog칤a").eq("mes",q).eq("anio",z).single();if(b&&"PGRST116"!==b.code){console.error("Error cargando liquidaci칩n:",b),Q(null),S(null);return}if(a){S(a);let b=await v(a.id,e.supabase);b?Q(b):Q(null)}else S(null),Q(null)}catch(a){console.error("Error cargando ExcelData:",a),Q(null),S(null)}finally{U(!1)}}(0,c.useEffect)(()=>{},[q,z]),(0,c.useEffect)(()=>{"historial"===L?aa():"excel"===L?V():_()},[q,z,L]);let W=(0,c.useRef)(new Map),X=(0,c.useRef)(null),Y=(0,c.useCallback)(async(a,b,c)=>{if(!R||!P)return;let d=a+1;P.rows[a]&&(P.rows[a][b]=c,Q({...P}));let e=`${R.id}-${d}-${b}`;W.current.set(e,{liquidacionId:R.id,filaExcel:d,columna:b,valor:c}),X.current&&clearTimeout(X.current),X.current=setTimeout(async()=>{await Z()},500)},[R,P]),Z=async()=>{if(0===W.current.size||!R)return;let a=Array.from(W.current.values());try{let b=new Map;a.forEach(a=>{b.has(a.filaExcel)||b.set(a.filaExcel,new Map);let c=b.get(a.filaExcel);a.columna.toLowerCase().includes("cliente")||a.columna.toLowerCase().includes("obra")?c.set("obra_social",a.valor):a.columna.toLowerCase().includes("responsable")||a.columna.toLowerCase().includes("medico")?c.set("medico_nombre",a.valor):a.columna.toLowerCase().includes("paciente")&&c.set("paciente",a.valor)});let c=Array.from(b.entries()).map(async([a,b])=>{let c={};b.forEach((a,b)=>{c[b]=a}),c.updated_at=new Date().toISOString();let{error:d}=await e.supabase.from("detalle_guardia").update(c).eq("liquidacion_id",R.id).eq("fila_excel",a);if(d)throw d});await Promise.all(c),W.current.clear()}catch(a){console.error("Error guardando cambios:",a)}},$=(0,c.useCallback)(async a=>{if(!R||!P)return;let b=P.rows[a];if(!b)return;let c=b.__fila_excel??a+1;try{let{error:a}=await e.supabase.from("detalle_guardia").delete().eq("liquidacion_id",R.id).eq("fila_excel",c);if(a)return void console.error("Error eliminando fila:",a);let b=await v(R.id,e.supabase);b&&Q(b);let d=async()=>{let{data:a}=await e.supabase.from("detalle_guardia").select("importe_calculado, monto_facturado").eq("liquidacion_id",R.id);if(a){let b=a.length,c=a.reduce((a,b)=>a+(b.monto_facturado||0),0),d=a.reduce((a,b)=>a+(b.importe_calculado||0),0);await e.supabase.from("liquidaciones_guardia").update({total_consultas:b,total_bruto:c,total_neto:d}).eq("id",R.id)}};setTimeout(d,100)}catch(a){console.error("Error eliminando fila:",a)}},[R,P]);async function _(){I(!0);try{let a=await h(q,z);E(a);let b=await g(q,z),c=new Map;b.forEach(a=>{let b=a.medico_id||"sin-id";c.has(b)||c.set(b,[]),c.get(b).push(a)}),C(c)}catch(a){console.error("Error cargando res칰menes:",a)}finally{I(!1)}}async function aa(){K(!0);try{let{data:a,error:b}=await e.supabase.from("liquidaciones_guardia").select("*").eq("especialidad","Ginecolog칤a").order("anio",{ascending:!1}).order("mes",{ascending:!1});if(b)throw b;G(a||[])}catch(a){console.error("Error cargando historial:",a)}finally{K(!1)}}function ab(a){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}let ac=Array.from(B.keys()).map(a=>{let b=B.get(a)||[];return b[0]?.medico_nombre||"Desconocido"}).sort();return(0,b.jsx)("div",{className:"min-h-screen p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(m.Button,{onClick:()=>a.push("/ginecologia"),variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,b.jsx)(n.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Volver"]}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-green-400",children:"Res칰menes de Liquidaci칩n - Ginecolog칤a"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-300",children:"Mes:"}),(0,b.jsx)("select",{value:q,onChange:a=>x(Number(a.target.value)),className:"px-3 py-2 bg-gray-800 border border-green-500/50 rounded-lg text-white focus:border-green-400 focus:outline-none",children:w.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-300",children:"A침o:"}),(0,b.jsx)("input",{type:"number",value:z,onChange:a=>A(Number(a.target.value)),className:"px-3 py-2 bg-gray-800 border border-green-500/50 rounded-lg text-white w-24 focus:border-green-400 focus:outline-none"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 border-b border-gray-700",children:[(0,b.jsx)("button",{onClick:()=>M("medicos"),className:`px-4 py-2 font-semibold transition-colors ${"medicos"===L?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:"Resumen por M칠dico"}),(0,b.jsx)("button",{onClick:()=>M("prestadores"),className:`px-4 py-2 font-semibold transition-colors ${"prestadores"===L?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:"Resumen por Prestador"}),(0,b.jsxs)("button",{onClick:()=>M("historial"),className:`px-4 py-2 font-semibold transition-colors flex items-center gap-2 ${"historial"===L?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:[(0,b.jsx)(r,{className:"h-4 w-4"}),"Historial"]}),(0,b.jsxs)("button",{onClick:()=>M("excel"),className:`px-4 py-2 font-semibold transition-colors flex items-center gap-2 ${"excel"===L?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:[(0,b.jsx)(t.FileSpreadsheet,{className:"h-4 w-4"}),"Excel"]})]}),"historial"===L?(0,b.jsx)("div",{className:"space-y-6",children:J?(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"Cargando historial..."}):0===F.length?(0,b.jsxs)("div",{className:"rounded-xl p-8 text-center",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[(0,b.jsx)("div",{className:"text-yellow-400 text-xl font-bold mb-4",children:"No hay liquidaciones procesadas"}),(0,b.jsx)("div",{className:"text-gray-400 mb-6",children:"A칰n no se ha procesado ning칰n archivo Excel de Ginecolog칤a."}),(0,b.jsx)(m.Button,{onClick:()=>a.push("/ginecologia"),className:"bg-green-600 hover:bg-green-500 text-white",children:"Ir a Ginecolog칤a"})]}):(0,b.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:"Historial de Liquidaciones"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Per칤odo"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"N춿 Liquidaci칩n"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Archivo"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center text-sm font-semibold text-green-400",children:"Estado"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Consultas"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total Bruto"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total Neto"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Fecha Procesamiento"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center text-sm font-semibold text-green-400",children:"Acciones"})]})}),(0,b.jsx)("tbody",{children:F.map(a=>{let c=a.created_at?new Date(a.created_at).toLocaleDateString("es-AR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",d=w.find(b=>b.value===a.mes)?.label||`Mes ${a.mes}`,e=N===a.id;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,b.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-300 font-medium",children:[d," ",a.anio]}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:a.numero_liquidacion||"-"}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:(0,b.jsx)("div",{className:"max-w-xs truncate",title:a.archivo_nombre||"",children:a.archivo_nombre||"Sin archivo"})}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-center",children:(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs font-semibold ${"finalizada"===a.estado?"bg-green-500/20 text-green-400":"procesando"===a.estado?"bg-yellow-500/20 text-yellow-400":"error"===a.estado?"bg-red-500/20 text-red-400":"bg-gray-500/20 text-gray-400"}`,children:a.estado})}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:a.total_consultas||0}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:ab(a.total_bruto||0)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right font-semibold",children:ab(a.total_neto||0)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:c}),(0,b.jsx)("td",{className:"px-4 py-3 text-center",children:(0,b.jsxs)(m.Button,{onClick:()=>{O(e?null:a.id)},variant:"outline",size:"sm",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,b.jsx)(s,{className:"h-4 w-4 mr-1"}),e?"Ocultar":"Ver"]})})]},a.id),e&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:9,className:"px-4 py-4 bg-gray-900/50",children:(0,b.jsx)(y,{liquidacionId:a.id})})})]})})})]})})]})}):"excel"===L?(0,b.jsx)("div",{className:"space-y-6",children:T?(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"Cargando Excel..."}):R?P?(0,b.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:["Excel - ",w.find(a=>a.value===q)?.label||`Mes ${q}`," ",z]}),(0,b.jsx)("p",{className:"text-gray-400 mb-4 text-sm",children:"Los cambios se guardan autom치ticamente. Revisa duplicados, filas sin obra social y sin horario."}),(0,b.jsx)(u.ExcelDataTable,{data:P,especialidad:"Ginecolog칤a",onCellUpdate:Y,onDeleteRow:$,liquidacionId:R.id,mes:q,anio:z})]}):(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No se pudo cargar el Excel"}):(0,b.jsxs)("div",{className:"rounded-xl p-8 text-center",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[(0,b.jsx)("div",{className:"text-yellow-400 text-xl font-bold mb-4",children:"No hay liquidaci칩n para este per칤odo"}),(0,b.jsxs)("div",{className:"text-gray-400 mb-6",children:["No se ha procesado ning칰n archivo Excel para ",w.find(a=>a.value===q)?.label||`Mes ${q}`," ",z,"."]}),(0,b.jsx)(m.Button,{onClick:()=>a.push("/ginecologia"),className:"bg-green-600 hover:bg-green-500 text-white",children:"Ir a Ginecolog칤a para procesar archivo"})]})}):H?(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"Cargando res칰menes..."}):0===B.size&&0===D.length?(0,b.jsxs)("div",{className:"rounded-xl p-8 text-center",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[(0,b.jsx)("div",{className:"text-yellow-400 text-xl font-bold mb-4",children:"No hay datos para el per칤odo seleccionado"}),(0,b.jsx)("div",{className:"text-gray-400 mb-6",children:"Para generar res칰menes, primero debes:"}),(0,b.jsxs)("ol",{className:"text-left text-gray-300 space-y-2 max-w-md mx-auto mb-6",children:[(0,b.jsxs)("li",{children:["1. Ir a la p치gina de ",(0,b.jsx)("strong",{className:"text-green-400",children:"Ginecolog칤a"})]}),(0,b.jsx)("li",{children:"2. Subir un archivo Excel con las consultas"}),(0,b.jsx)("li",{children:"3. Confirmar el mes y a침o del per칤odo"}),(0,b.jsx)("li",{children:"4. El sistema guardar치 autom치ticamente los datos"})]}),(0,b.jsx)(m.Button,{onClick:()=>a.push("/ginecologia"),className:"bg-green-600 hover:bg-green-500 text-white",children:"Ir a Ginecolog칤a"})]}):"medicos"===L?(0,b.jsx)("div",{className:"space-y-6",children:0===ac.length?(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No hay datos para el per칤odo seleccionado"}):ac.map(a=>{let c=Array.from(B.keys()).find(b=>{let c=B.get(b)||[];return c[0]?.medico_nombre===a}),d=c&&B.get(c)||[],e=d.reduce((a,b)=>a+b.total,0),g=d.reduce((a,b)=>a+b.cantidad,0);return(0,b.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-green-400",children:a}),(0,b.jsxs)(m.Button,{onClick:()=>{!function({resumenes:a,mes:b,anio:c,medicoNombre:d}){let e=new i.default({orientation:"portrait",unit:"mm",format:"a4"}),g=20,h=(0,f.calcularNumeroLiquidacion)(b,c);e.setFontSize(11),e.setTextColor(34,197,94),e.setFont("helvetica","bold"),e.text("Grow Labs",15,g),e.setFontSize(7.5),e.setTextColor(100,100,100),e.setFont("helvetica","normal"),e.text("Sistema de Liquidaciones de Guardias",15,g+5),g+=15,e.setFontSize(16),e.setTextColor(0,0,0),e.setFont("helvetica","bold"),e.text(d.toUpperCase(),15,g);let l=g+=10;e.setFillColor(240,240,240),e.setDrawColor(200,200,200),e.roundedRect(105,l,90,30,2,2,"FD");let m=l+3.75;e.setFontSize(8.5),e.setTextColor(0,0,0),e.setFont("helvetica","bold"),e.text("Mes:",109.5,m),e.setFont("helvetica","normal"),e.text(k[b-1],151.5,m),m+=7.5,e.setFont("helvetica","bold"),e.text("A침o:",109.5,m),e.setFont("helvetica","normal"),e.text(String(c),151.5,m),m+=7.5,e.setFont("helvetica","bold"),e.text("Liq:",109.5,m),e.setFont("helvetica","normal"),e.text(String(h),151.5,m),m+=7.5,e.setFont("helvetica","bold"),e.text("Generado:",109.5,m),e.setFont("helvetica","normal");let n=new Date().toLocaleDateString("es-AR");e.text(n,151.5,m),g=l+30+10;let o=a.map(a=>[a.obra_social,String(a.cantidad),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.valor_unitario),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.total)]),p=a.reduce((a,b)=>a+b.cantidad,0),q=a.reduce((a,b)=>a+b.total,0);o.push(["TOTAL",String(p),"",new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(q)]);(0,j.default)(e,{startY:g,head:[["Obra social","Cantidad","Valor unitario","Total"]],body:o,theme:"striped",headStyles:{fillColor:[34,197,94],textColor:[255,255,255],fontStyle:"bold",fontSize:9,halign:"left"},bodyStyles:{fontSize:8,textColor:[0,0,0],cellPadding:2,halign:"left"},columnStyles:{0:{cellWidth:70,fontStyle:"bold"},1:{cellWidth:30,halign:"right"},2:{cellWidth:40,halign:"right"},3:{cellWidth:40,halign:"right",fontStyle:"bold"}},styles:{lineColor:[220,220,220],lineWidth:.1,valign:"middle"},margin:{left:15,right:15},tableWidth:180,showHead:"everyPage",pageBreak:"auto",rowPageBreak:"avoid",didParseCell:a=>{a.row.index===o.length-1&&(a.cell.styles.fillColor=[240,240,240],a.cell.styles.fontStyle="bold")}});let r=e.getNumberOfPages();for(let a=1;a<=r;a++)e.setPage(a),e.setFontSize(7),e.setTextColor(150,150,150),e.setFont("helvetica","italic"),e.text(`P\xe1gina ${a} de ${r} - Powered by Grow Labs 游꺔`,105,287,{align:"center"});let s=`Resumen_${d.replace(/[^a-zA-Z0-9]/g,"_")}_${k[b-1]}_${c}.pdf`;e.save(s)}({resumenes:d,mes:q,anio:z,medicoNombre:a})},variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,b.jsx)(o.FileDown,{className:"h-4 w-4 mr-2"}),"Exportar PDF"]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Obra social"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Cantidad"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Valor unitario"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total"})]})}),(0,b.jsxs)("tbody",{children:[d.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:a.obra_social}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:a.cantidad}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:ab(a.valor_unitario)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right font-semibold",children:ab(a.total)})]},c)),(0,b.jsxs)("tr",{className:"bg-gray-800/50 font-bold",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400",children:"TOTAL"}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:g}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right"}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:ab(e)})]})]})]})})]},a)})}):(0,b.jsx)("div",{className:"space-y-6",children:0===D.length?(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No hay datos para el per칤odo seleccionado"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsxs)(m.Button,{onClick:function(){!function({resumenes:a,mes:b,anio:c}){let d=new i.default({orientation:"portrait",unit:"mm",format:"a4"}),e=20,g=(0,f.calcularNumeroLiquidacion)(b,c);d.setFontSize(11),d.setTextColor(34,197,94),d.setFont("helvetica","bold"),d.text("Grow Labs",15,e),d.setFontSize(7.5),d.setTextColor(100,100,100),d.setFont("helvetica","normal"),d.text("Sistema de Liquidaciones de Guardias",15,e+5),e+=15,d.setFontSize(16),d.setTextColor(0,0,0),d.setFont("helvetica","bold"),d.text("Guardia Ginecol칩gica",15,e),d.setFontSize(12),d.setTextColor(100,100,100),d.setFont("helvetica","normal"),d.text(`${l[b-1]} ${c}`,15,e+7);let h=e+=15;d.setFillColor(240,240,240),d.setDrawColor(200,200,200),d.roundedRect(105,h,90,22.5,2,2,"FD");let k=h+3.75;d.setFontSize(8.5),d.setTextColor(0,0,0),d.setFont("helvetica","bold"),d.text("Mes:",109.5,k),d.setFont("helvetica","normal"),d.text(l[b-1],151.5,k),k+=7.5,d.setFont("helvetica","bold"),d.text("A침o:",109.5,k),d.setFont("helvetica","normal"),d.text(String(c),151.5,k),k+=7.5,d.setFont("helvetica","bold"),d.text("Liq:",109.5,k),d.setFont("helvetica","normal"),d.text(String(g),151.5,k),e=h+22.5+10;let m=a.map(a=>[a.medico_nombre,String(a.cantidad),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.total_bruto),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.retencion_20),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.total_neto)]),n=a.reduce((a,b)=>a+b.cantidad,0),o=a.reduce((a,b)=>a+b.total_bruto,0),p=a.reduce((a,b)=>a+b.retencion_20,0),q=a.reduce((a,b)=>a+b.total_neto,0);m.push(["Total general",String(n),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(o),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(p),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(q)]);(0,j.default)(d,{startY:e,head:[["Prestador","Cantidad","Total bruto","Retenci칩n 20%","Total Neto"]],body:m,theme:"striped",headStyles:{fillColor:[34,197,94],textColor:[255,255,255],fontStyle:"bold",fontSize:9,halign:"left"},bodyStyles:{fontSize:8,textColor:[0,0,0],cellPadding:2,halign:"left"},columnStyles:{0:{cellWidth:60,fontStyle:"bold"},1:{cellWidth:25,halign:"right"},2:{cellWidth:35,halign:"right"},3:{cellWidth:30,halign:"right"},4:{cellWidth:30,halign:"right",fontStyle:"bold"}},styles:{lineColor:[220,220,220],lineWidth:.1,valign:"middle"},margin:{left:15,right:15},tableWidth:180,showHead:"everyPage",pageBreak:"auto",rowPageBreak:"avoid",didParseCell:a=>{a.row.index===m.length-1&&(a.cell.styles.fillColor=[240,240,240],a.cell.styles.fontStyle="bold")}});let r=d.getNumberOfPages();for(let a=1;a<=r;a++)d.setPage(a),d.setFontSize(7),d.setTextColor(150,150,150),d.setFont("helvetica","italic"),d.text(`P\xe1gina ${a} de ${r} - Powered by Grow Labs 游꺔`,105,287,{align:"center"});let s=`Resumen_Prestadores_${l[b-1]}_${c}.pdf`;d.save(s)}({resumenes:D,mes:q,anio:z})},variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,b.jsx)(p.Download,{className:"h-4 w-4 mr-2"}),"Exportar PDF Completo"]})}),(0,b.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:"Resumen por Prestador"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Prestador"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Cantidad"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total bruto"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Retenci칩n 20%"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total Neto"})]})}),(0,b.jsxs)("tbody",{children:[D.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 font-medium",children:a.medico_nombre}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:a.cantidad}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:ab(a.total_bruto)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:ab(a.retencion_20)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right font-semibold",children:ab(a.total_neto)})]},c)),(0,b.jsxs)("tr",{className:"bg-gray-800/50 font-bold",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400",children:"Total general"}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:D.reduce((a,b)=>a+b.cantidad,0)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:ab(D.reduce((a,b)=>a+b.total_bruto,0))}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:ab(D.reduce((a,b)=>a+b.retencion_20,0))}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:ab(D.reduce((a,b)=>a+b.total_neto,0))})]})]})]})})]})]})})]})})}function y({liquidacionId:a}){let[d,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!1);async function i(){h(!0);try{let{data:b,error:c}=await e.supabase.from("detalle_guardia").select("*").eq("liquidacion_id",a).order("fecha",{ascending:!0}).order("hora",{ascending:!0}).limit(100);if(c)throw c;f(b||[])}catch(a){console.error("Error cargando detalles:",a)}finally{h(!1)}}function j(a){return a?new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a):"$0.00"}return((0,c.useEffect)(()=>{i()},[a]),g)?(0,b.jsx)("div",{className:"text-center py-4 text-gray-400",children:"Cargando detalles..."}):0===d.length?(0,b.jsx)("div",{className:"text-center py-4 text-gray-400",children:"No hay detalles disponibles"}):(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-green-400 mb-3",children:["Detalle de Consultas (",d.length," registros)"]}),(0,b.jsx)("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"sticky top-0 bg-gray-900",children:(0,b.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"Fecha"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"Hora"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"M칠dico"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"Paciente"}),(0,b.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-green-400",children:"Obra Social"}),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-green-400",children:"Monto Facturado"}),(0,b.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-green-400",children:"Importe Calculado"}),(0,b.jsx)("th",{className:"px-3 py-2 text-center text-xs font-semibold text-green-400",children:"Horario Formativo"})]})}),(0,b.jsx)("tbody",{children:d.map(a=>{var c;return(0,b.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/30",children:[(0,b.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:(c=a.fecha)?new Date(c).toLocaleDateString("es-AR"):"-"}),(0,b.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:a.hora||"-"}),(0,b.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:a.medico_nombre||"-"}),(0,b.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:a.paciente||"-"}),(0,b.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300",children:a.obra_social||"-"}),(0,b.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300 text-right",children:j(a.monto_facturado)}),(0,b.jsx)("td",{className:"px-3 py-2 text-xs text-gray-300 text-right font-semibold",children:j(a.importe_calculado)}),(0,b.jsx)("td",{className:"px-3 py-2 text-xs text-center",children:a.es_horario_formativo?(0,b.jsx)("span",{className:"text-yellow-400",children:"S칤"}):(0,b.jsx)("span",{className:"text-gray-500",children:"No"})})]},a.id)})})]})}),d.length>=100&&(0,b.jsx)("div",{className:"mt-2 text-xs text-gray-400 text-center",children:"Mostrando los primeros 100 registros"})]})}a.s(["default",()=>x],55649)}];

//# sourceMappingURL=Desktop_Osde_Liquidaciones_Guardias_app_ginecologia_resumenes_page_tsx_66ac2908._.js.map