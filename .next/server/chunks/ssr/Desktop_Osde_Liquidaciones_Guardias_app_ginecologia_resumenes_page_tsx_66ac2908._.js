module.exports=[55649,a=>{"use strict";var b=a.i(24793),c=a.i(21439),d=a.i(48168),e=a.i(19147),f=a.i(5415);async function g(a,b){let{data:c}=await e.supabase.from("liquidaciones_guardia").select("id").eq("especialidad","Ginecolog칤a").eq("mes",a).eq("anio",b).single();if(!c||!c.id)return[];let d=c.id,{data:g}=await e.supabase.from("detalle_guardia").select("*").eq("liquidacion_id",d);if(!g||0===g.length)return[];let{data:h}=await e.supabase.from("valores_consultas_obra_social").select("*").eq("tipo_consulta","CONSULTA GINECOLOGICA").eq("mes",a).eq("anio",b);if(!h||0===h.length)return[];let i=new Map;h.forEach(a=>{i.set(a.obra_social,a.valor)});let j=new Map;return g.forEach(a=>{let b=!0===a.medico_es_residente;if((0,f.esResidenteHorarioFormativo)(a.fecha,a.hora,b))return;let c=a.obra_social||"PARTICULARES",d=a.medico_nombre||"Desconocido",e=a.medico_id||"sin-id",g=`${e}|${c}`,h=i.get(c)||0;if(j.has(g)){let a=j.get(g);a.cantidad+=1,a.total=a.cantidad*a.valor_unitario}else j.set(g,{medico_id:a.medico_id,medico_nombre:d,obra_social:c,cantidad:1,valor_unitario:h,total:h})}),Array.from(j.values()).sort((a,b)=>a.medico_nombre!==b.medico_nombre?a.medico_nombre.localeCompare(b.medico_nombre):a.obra_social.localeCompare(b.obra_social))}async function h(a,b){let c=await g(a,b),d=new Map;return c.forEach(a=>{let b=a.medico_id||"sin-id",c=a.medico_nombre;if(d.has(b)){let c=d.get(b);c.cantidad+=a.cantidad,c.total_bruto+=a.total,c.retencion_20=.2*c.total_bruto,c.total_neto=c.total_bruto-c.retencion_20}else{let e=a.total,f=.2*e;d.set(b,{medico_id:a.medico_id,medico_nombre:c,cantidad:a.cantidad,total_bruto:e,retencion_20:f,total_neto:e-f})}}),Array.from(d.values()).sort((a,b)=>a.medico_nombre.localeCompare(b.medico_nombre))}var i=a.i(22254),j=a.i(65266);let k=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],l=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];var m=a.i(44874),n=a.i(53315),o=a.i(74961),p=a.i(84230);let q=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}];function r(){let a=(0,d.useRouter)(),[e,r]=(0,c.useState)(new Date().getMonth()+1),[s,t]=(0,c.useState)(new Date().getFullYear()),[u,v]=(0,c.useState)(new Map),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)("medicos");async function C(){z(!0);try{let a=await h(e,s);x(a);let b=await g(e,s),c=new Map;b.forEach(a=>{let b=a.medico_id||"sin-id";c.has(b)||c.set(b,[]),c.get(b).push(a)}),v(c)}catch(a){console.error("Error cargando res칰menes:",a)}finally{z(!1)}}function D(a){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}(0,c.useEffect)(()=>{C()},[e,s]);let E=Array.from(u.keys()).map(a=>{let b=u.get(a)||[];return b[0]?.medico_nombre||"Desconocido"}).sort();return(0,b.jsx)("div",{className:"min-h-screen p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(m.Button,{onClick:()=>a.push("/ginecologia"),variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,b.jsx)(n.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Volver"]}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-green-400",children:"Res칰menes de Liquidaci칩n - Ginecolog칤a"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 rounded-xl",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-300",children:"Mes:"}),(0,b.jsx)("select",{value:e,onChange:a=>r(Number(a.target.value)),className:"px-3 py-2 bg-gray-800 border border-green-500/50 rounded-lg text-white focus:border-green-400 focus:outline-none",children:q.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-gray-300",children:"A침o:"}),(0,b.jsx)("input",{type:"number",value:s,onChange:a=>t(Number(a.target.value)),className:"px-3 py-2 bg-gray-800 border border-green-500/50 rounded-lg text-white w-24 focus:border-green-400 focus:outline-none"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 border-b border-gray-700",children:[(0,b.jsx)("button",{onClick:()=>B("medicos"),className:`px-4 py-2 font-semibold transition-colors ${"medicos"===A?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:"Resumen por M칠dico"}),(0,b.jsx)("button",{onClick:()=>B("prestadores"),className:`px-4 py-2 font-semibold transition-colors ${"prestadores"===A?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-gray-300"}`,children:"Resumen por Prestador"})]}),y?(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"Cargando res칰menes..."}):0===u.size&&0===w.length?(0,b.jsxs)("div",{className:"rounded-xl p-8 text-center",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[(0,b.jsx)("div",{className:"text-yellow-400 text-xl font-bold mb-4",children:"No hay datos para el per칤odo seleccionado"}),(0,b.jsx)("div",{className:"text-gray-400 mb-6",children:"Para generar res칰menes, primero debes:"}),(0,b.jsxs)("ol",{className:"text-left text-gray-300 space-y-2 max-w-md mx-auto mb-6",children:[(0,b.jsxs)("li",{children:["1. Ir a la p치gina de ",(0,b.jsx)("strong",{className:"text-green-400",children:"Ginecolog칤a"})]}),(0,b.jsx)("li",{children:"2. Subir un archivo Excel con las consultas"}),(0,b.jsx)("li",{children:"3. Confirmar el mes y a침o del per칤odo"}),(0,b.jsx)("li",{children:"4. El sistema guardar치 autom치ticamente los datos"})]}),(0,b.jsx)(m.Button,{onClick:()=>a.push("/ginecologia"),className:"bg-green-600 hover:bg-green-500 text-white",children:"Ir a Ginecolog칤a"})]}):"medicos"===A?(0,b.jsx)("div",{className:"space-y-6",children:0===E.length?(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No hay datos para el per칤odo seleccionado"}):E.map(a=>{let c=Array.from(u.keys()).find(b=>{let c=u.get(b)||[];return c[0]?.medico_nombre===a}),d=c&&u.get(c)||[],g=d.reduce((a,b)=>a+b.total,0),h=d.reduce((a,b)=>a+b.cantidad,0);return(0,b.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-green-400",children:a}),(0,b.jsxs)(m.Button,{onClick:()=>{!function({resumenes:a,mes:b,anio:c,medicoNombre:d}){let e=new i.default({orientation:"portrait",unit:"mm",format:"a4"}),g=20,h=(0,f.calcularNumeroLiquidacion)(b,c);e.setFontSize(11),e.setTextColor(34,197,94),e.setFont("helvetica","bold"),e.text("Grow Labs",15,g),e.setFontSize(7.5),e.setTextColor(100,100,100),e.setFont("helvetica","normal"),e.text("Sistema de Liquidaciones de Guardias",15,g+5),g+=15,e.setFontSize(16),e.setTextColor(0,0,0),e.setFont("helvetica","bold"),e.text(d.toUpperCase(),15,g);let l=g+=10;e.setFillColor(240,240,240),e.setDrawColor(200,200,200),e.roundedRect(105,l,90,30,2,2,"FD");let m=l+3.75;e.setFontSize(8.5),e.setTextColor(0,0,0),e.setFont("helvetica","bold"),e.text("Mes:",109.5,m),e.setFont("helvetica","normal"),e.text(k[b-1],151.5,m),m+=7.5,e.setFont("helvetica","bold"),e.text("A침o:",109.5,m),e.setFont("helvetica","normal"),e.text(String(c),151.5,m),m+=7.5,e.setFont("helvetica","bold"),e.text("Liq:",109.5,m),e.setFont("helvetica","normal"),e.text(String(h),151.5,m),m+=7.5,e.setFont("helvetica","bold"),e.text("Generado:",109.5,m),e.setFont("helvetica","normal");let n=new Date().toLocaleDateString("es-AR");e.text(n,151.5,m),g=l+30+10;let o=a.map(a=>[a.obra_social,String(a.cantidad),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.valor_unitario),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.total)]),p=a.reduce((a,b)=>a+b.cantidad,0),q=a.reduce((a,b)=>a+b.total,0);o.push(["TOTAL",String(p),"",new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(q)]);(0,j.default)(e,{startY:g,head:[["Obra social","Cantidad","Valor unitario","Total"]],body:o,theme:"striped",headStyles:{fillColor:[34,197,94],textColor:[255,255,255],fontStyle:"bold",fontSize:9,halign:"left"},bodyStyles:{fontSize:8,textColor:[0,0,0],cellPadding:2,halign:"left"},columnStyles:{0:{cellWidth:70,fontStyle:"bold"},1:{cellWidth:30,halign:"right"},2:{cellWidth:40,halign:"right"},3:{cellWidth:40,halign:"right",fontStyle:"bold"}},styles:{lineColor:[220,220,220],lineWidth:.1,valign:"middle"},margin:{left:15,right:15},tableWidth:180,showHead:"everyPage",pageBreak:"auto",rowPageBreak:"avoid",didParseCell:a=>{a.row.index===o.length-1&&(a.cell.styles.fillColor=[240,240,240],a.cell.styles.fontStyle="bold")}});let r=e.getNumberOfPages();for(let a=1;a<=r;a++)e.setPage(a),e.setFontSize(7),e.setTextColor(150,150,150),e.setFont("helvetica","italic"),e.text(`P\xe1gina ${a} de ${r} - Powered by Grow Labs 游꺔`,105,287,{align:"center"});let s=`Resumen_${d.replace(/[^a-zA-Z0-9]/g,"_")}_${k[b-1]}_${c}.pdf`;e.save(s)}({resumenes:d,mes:e,anio:s,medicoNombre:a})},variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,b.jsx)(o.FileDown,{className:"h-4 w-4 mr-2"}),"Exportar PDF"]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Obra social"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Cantidad"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Valor unitario"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total"})]})}),(0,b.jsxs)("tbody",{children:[d.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300",children:a.obra_social}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:a.cantidad}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:D(a.valor_unitario)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right font-semibold",children:D(a.total)})]},c)),(0,b.jsxs)("tr",{className:"bg-gray-800/50 font-bold",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400",children:"TOTAL"}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:h}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right"}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:D(g)})]})]})]})})]},a)})}):(0,b.jsx)("div",{className:"space-y-6",children:0===w.length?(0,b.jsx)("div",{className:"text-center py-12 text-gray-400",children:"No hay datos para el per칤odo seleccionado"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsxs)(m.Button,{onClick:function(){!function({resumenes:a,mes:b,anio:c}){let d=new i.default({orientation:"portrait",unit:"mm",format:"a4"}),e=20,g=(0,f.calcularNumeroLiquidacion)(b,c);d.setFontSize(11),d.setTextColor(34,197,94),d.setFont("helvetica","bold"),d.text("Grow Labs",15,e),d.setFontSize(7.5),d.setTextColor(100,100,100),d.setFont("helvetica","normal"),d.text("Sistema de Liquidaciones de Guardias",15,e+5),e+=15,d.setFontSize(16),d.setTextColor(0,0,0),d.setFont("helvetica","bold"),d.text("Guardia Ginecol칩gica",15,e),d.setFontSize(12),d.setTextColor(100,100,100),d.setFont("helvetica","normal"),d.text(`${l[b-1]} ${c}`,15,e+7);let h=e+=15;d.setFillColor(240,240,240),d.setDrawColor(200,200,200),d.roundedRect(105,h,90,22.5,2,2,"FD");let k=h+3.75;d.setFontSize(8.5),d.setTextColor(0,0,0),d.setFont("helvetica","bold"),d.text("Mes:",109.5,k),d.setFont("helvetica","normal"),d.text(l[b-1],151.5,k),k+=7.5,d.setFont("helvetica","bold"),d.text("A침o:",109.5,k),d.setFont("helvetica","normal"),d.text(String(c),151.5,k),k+=7.5,d.setFont("helvetica","bold"),d.text("Liq:",109.5,k),d.setFont("helvetica","normal"),d.text(String(g),151.5,k),e=h+22.5+10;let m=a.map(a=>[a.medico_nombre,String(a.cantidad),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.total_bruto),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.retencion_20),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(a.total_neto)]),n=a.reduce((a,b)=>a+b.cantidad,0),o=a.reduce((a,b)=>a+b.total_bruto,0),p=a.reduce((a,b)=>a+b.retencion_20,0),q=a.reduce((a,b)=>a+b.total_neto,0);m.push(["Total general",String(n),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(o),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(p),new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:2,maximumFractionDigits:2}).format(q)]);(0,j.default)(d,{startY:e,head:[["Prestador","Cantidad","Total bruto","Retenci칩n 20%","Total Neto"]],body:m,theme:"striped",headStyles:{fillColor:[34,197,94],textColor:[255,255,255],fontStyle:"bold",fontSize:9,halign:"left"},bodyStyles:{fontSize:8,textColor:[0,0,0],cellPadding:2,halign:"left"},columnStyles:{0:{cellWidth:60,fontStyle:"bold"},1:{cellWidth:25,halign:"right"},2:{cellWidth:35,halign:"right"},3:{cellWidth:30,halign:"right"},4:{cellWidth:30,halign:"right",fontStyle:"bold"}},styles:{lineColor:[220,220,220],lineWidth:.1,valign:"middle"},margin:{left:15,right:15},tableWidth:180,showHead:"everyPage",pageBreak:"auto",rowPageBreak:"avoid",didParseCell:a=>{a.row.index===m.length-1&&(a.cell.styles.fillColor=[240,240,240],a.cell.styles.fontStyle="bold")}});let r=d.getNumberOfPages();for(let a=1;a<=r;a++)d.setPage(a),d.setFontSize(7),d.setTextColor(150,150,150),d.setFont("helvetica","italic"),d.text(`P\xe1gina ${a} de ${r} - Powered by Grow Labs 游꺔`,105,287,{align:"center"});let s=`Resumen_Prestadores_${l[b-1]}_${c}.pdf`;d.save(s)}({resumenes:w,mes:e,anio:s})},variant:"outline",className:"border-green-500/50 text-green-400 hover:bg-green-500/20",children:[(0,b.jsx)(p.Download,{className:"h-4 w-4 mr-2"}),"Exportar PDF Completo"]})}),(0,b.jsxs)("div",{className:"rounded-xl p-6",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(20px)",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-green-400 mb-4",children:"Resumen por Prestador"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-green-400",children:"Prestador"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Cantidad"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total bruto"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Retenci칩n 20%"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-green-400",children:"Total Neto"})]})}),(0,b.jsxs)("tbody",{children:[w.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 font-medium",children:a.medico_nombre}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:a.cantidad}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:D(a.total_bruto)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right",children:D(a.retencion_20)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-300 text-right font-semibold",children:D(a.total_neto)})]},c)),(0,b.jsxs)("tr",{className:"bg-gray-800/50 font-bold",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400",children:"Total general"}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:w.reduce((a,b)=>a+b.cantidad,0)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:D(w.reduce((a,b)=>a+b.total_bruto,0))}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:D(w.reduce((a,b)=>a+b.retencion_20,0))}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-green-400 text-right",children:D(w.reduce((a,b)=>a+b.total_neto,0))})]})]})]})})]})]})})]})})}a.s(["default",()=>r],55649)}];

//# sourceMappingURL=Desktop_Osde_Liquidaciones_Guardias_app_ginecologia_resumenes_page_tsx_66ac2908._.js.map